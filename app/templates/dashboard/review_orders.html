<!-- templates/index.html -->

{% extends "dashboard/base.html" %}
{% load static extra_tags %}

{% block content %}

<div role="tooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium transition-opacity duration-300 bg-gray-900 rounded-full shadow-sm opacity-0 tooltip dark:bg-gray-700">\
    Tooltip content\
    <div class="tooltip-arrow" data-popper-arrow></div>\
</div>

<section class="flex h-screen bg-white antialiased">
    <div class="w-full mx-auto">
        <div class="relative overflow-hidden">
            <div class="px-4">
                <div class="flex flex-col py-3 space-y-3 md:flex-row md:items-center md:justify-between md:space-y-0 md:space-x-4">
                    <h4 class="font-mono text-xl font-bold dark:text-black">Bestellungen</h4>
                </div>
    
                <!-- TABS -->
                <ul class="flex flex-wrap text-sm font-medium text-center text-gray-500 dark:text-gray-400">
                    <li class="me-2">
                        <a href="{% url 'dashboard_orders' %}"  class="inline-block px-4 py-3 rounded-full hover:text-gray-900 hover:bg-gray-100">Bestellungen</a>
                    </li>
                    <li class="me-2">
                        <a href="{% url 'dashboard_order_products' %}" class="inline-block px-4 py-3 hover:text-gray-900 hover:bg-gray-100 rounded-full" aria-current="page">Produkte</a>
                    </li>
                    <li class="me-2">
                        <a href="{% url 'dashboard_review_orders' %}" class="inline-block px-4 py-3 bg-emerald-600 text-white rounded-full" aria-current="page">Eingang</a>
                    </li>
                </ul>
    
                <div class="flex flex-col bg-white relative overflow-hidden" style="height: calc(100vh - 64px - 2.5rem);">
                    <div class="flex flex-col md:items-start md:justify-between space-y-3 py-4">
                        <div class="flex-1 flex items-center space-x-2">
                            <div class="font-medium text-gray-500 dark:text-gray-400">
                                {{ orders.paginator.count }} Ergebnisse
                            </div>
                        </div>
                        {% if request|check_get_parameters_exist:'search;search_invoice;search_product;status;online_recipe_status;recipe_status;payment_status;delivery_type;payment_type;customer_type' %}
                        <div class="flex-1 flex items-center border-gray-600 w-full filter-parameters">
                            <svg class="w-4 h-4 text-gray-500 dark:text-gray-400 me-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M5.05 3C3.291 3 2.352 5.024 3.51 6.317l5.422 6.059v4.874c0 .472.227.917.613 1.2l3.069 2.25c1.01.742 2.454.036 2.454-1.2v-7.124l5.422-6.059C21.647 5.024 20.708 3 18.95 3H5.05Z"/>
                            </svg>
                            <div class="flex-1 flex flex-wrap divide-x divide-gray-500 dark:divide-gray-400 w-full">
                                {% if request|get_parameter:'search' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">Suche: {{ request|get_parameter:'search' }}</p>
                                {% endif %}
                                {% if request|get_parameter:'search_invoice' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">Rechnung: {{ request|get_parameter:'search_invoice' }}</p>
                                {% endif %}
                                {% if request|get_parameter:'search_product' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">Produkt: {{ request|get_parameter:'search_product' }}</p>
                                {% endif %}
                                {% if request|get_parameter:'status' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">Lieferstatus: {{ request|get_parameter:'status' }}</p>
                                {% endif %}
                                {% if request|get_parameter:'online_recipe_status' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">(Online) Rezeptstatus: {{ request|get_parameter:'online_recipe_status' }}</p>
                                {% endif %}
                                {% if request|get_parameter:'recipe_status' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">Original Rezeptstatus: {{ request|get_parameter:'recipe_status' }}</p>
                                {% endif %}
                                {% if request|get_parameter:'payment_status' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">Bezahlstatus: {{ request|get_parameter:'payment_status' }}</p>
                                {% endif %}
                                {% if request|get_parameter:'delivery_type' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">Versandart: {{ request|get_parameter:'delivery_type' }}</p>
                                {% endif %}
                                {% if request|get_parameter:'payment_type' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">Zahlungsmethode: {{ request|get_parameter:'payment_type' }}</p>
                                {% endif %}
                                {% if request|get_parameter:'customer_type' %}
                                <p class="text-gray-500 dark:text-gray-400 px-3 text-xs whitespace-nowrap">Rezeptart: {{ request|get_parameter:'customer_type' }}</p>
                                {% endif %}
                            </div>
                            <button type="button" onclick="resetFilter()" class="flex items-center justify-center focus:outline-none text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-full text-sm px-4 py-2 me-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900">
                                <svg class="w-4 h-4 text-gray-800 mr-1.5 -ml-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                    <path fill-rule="evenodd" d="M8.586 2.586A2 2 0 0 1 10 2h4a2 2 0 0 1 2 2v2h3a1 1 0 1 1 0 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a1 1 0 0 1 0-2h3V4a2 2 0 0 1 .586-1.414ZM10 6h4V4h-4v2Zm1 4a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Zm4 0a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Z" clip-rule="evenodd"/>
                                </svg>
                                Filter löschen
                            </button>
                        </div>
                        {% endif %}
                    </div>
                    <div class="flex flex-col md:flex-row py-4 border-t">
                        <div>
                            <div class="flex">
                                <button id="searchDropdownButton" data-dropdown-toggle="searchDropdownCategories" class="flex-shrink-0 z-10 inline-flex items-center py-2.5 px-4 text-sm font-medium text-center text-white bg-gray-800 border border-gray-300 rounded-s-full hover:bg-gray-700 focus:ring-4 focus:outline-none" type="button">
                                    <span>Alle Kategorien</span>
                                    <svg class="w-2.5 h-2.5 ms-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"/>
                                    </svg>
                                </button>
                                <div id="searchDropdownCategories" class="z-10 hidden bg-white divide-y divide-gray-100 rounded-full shadow w-44 dark:bg-gray-700">
                                    <ul class="py-2 text-sm text-gray-700 dark:text-gray-200" aria-labelledby="dropdown-button">
                                        <li>
                                            <button type="button" onclick="selectSearchCategory(this, 'search')" class="inline-flex w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Alle Kategorien</button>
                                        </li>
                                        <li>
                                            <button type="button" onclick="selectSearchCategory(this, 'search_invoice')" class="inline-flex w-full px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Rechnungsnummer</button>
                                        </li>
                                    </ul>
                                </div>
                                <div class="relative w-full">
                                    <input type="search" id="searchOrderInput" data-search-category="search" class="w-64 block p-2.5 z-20 text-sm text-gray-900 bg-gray-50 rounded-e-full border-s-gray-50 border-s-2 border border-gray-300 focus:ring-emerald-500 focus:border-emerald-500 dark:border-s-gray-700  dark:placeholder-gray-400 dark:focus:border-emerald-500" placeholder="Bestellnummer, Name, E-Mail..." required />
                                </div>
                                <button type="button" onclick="searchOrder()" class="flex mr-2 items-center justify-center px-4 py-2 ms-2 text-sm font-medium text-white rounded-full bg-emerald-600 hover:bg-emerald-700 focus:ring-4 focus:ring-emerald-300 dark:bg-emerald-600 dark:hover:bg-emerald-700 focus:outline-none dark:focus:ring-emerald-800">
                                    <svg class="h-3.5 w-3.5 me-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"/>
                                    </svg>
                                    Suchen
                                </button>
                            </div>
                        </div>
                        <div class="ml-auto me-3 flex flex-row">
                            <div class="relative searchProductContainer">
                                <div class="absolute inset-y-0 start-0 flex items-center ps-4 pointer-events-none">
                                    <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12.013 6.175 7.006 9.369l5.007 3.194-5.007 3.193L2 12.545l5.006-3.193L2 6.175l5.006-3.194 5.007 3.194ZM6.981 17.806l5.006-3.193 5.006 3.193L11.987 21l-5.006-3.194Z"/>
                                        <path d="m12.013 12.545 5.006-3.194-5.006-3.176 4.98-3.194L22 6.175l-5.007 3.194L22 12.562l-5.007 3.194-4.98-3.211Z"/>
                                    </svg>
                                </div>
                                <input type="text" dropdown-max-height="600" dropdown-width="400" data-search-type="global-search-product" class="h-full searchProductInput bg-gray-50 border w-full border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block ps-10 p-2 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Produktsuche" required>
                            </div>
                        </div>
                        <div class="text-gray-500 w-full md:w-auto flex flex-col md:flex-row space-y-2 md:space-y-0 items-stretch md:items-center justify-end md:space-x-3 flex-shrink-0">
                            <button id="filterDropdownButton" disabled data-dropdown-toggle="filterDropdown" class="text-gray-500 h-full w-full md:w-auto flex items-center justify-center py-2 px-4 text-sm font-medium focus:outline-none bg-white rounded-full border border-gray-200 hover:bg-gray-100 hover:text-emerald-700 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:hover:text-white dark:hover:bg-gray-700" type="button">
                                <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" class="text-gray-500 h-4 w-4 mr-1.5 -ml-1 text-gray-400" viewbox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z" clip-rule="evenodd" />
                                </svg>
                                Filtern
                                <svg class="-mr-1 ml-1.5 w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                    <path clip-rule="evenodd" fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                                </svg>
                            </button>
                            <div id="filterDropdown" class="z-10 hidden px-3 pt-1 bg-white rounded-full shadow w-80 right-0">
                                <div id="accordion-flush" data-accordion="collapse" data-active-classes="text-black" data-inactive-classes="text-gray-500 dark:text-gray-400">
                                    <!-- Lieferstatus -->
                                    <h2 id="status-heading">
                                        <button type="button" class="flex items-center justify-between w-full py-2 px-1.5 text-sm font-medium text-left text-gray-500 border-b border-gray-200 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700" data-accordion-target="#status-body" aria-expanded="true" aria-controls="status-body">
                                            <div>
                                                <span class="mr-2">Lieferstatus</span>
                                                {% if request|get_parameter:'status' %}
                                                <span class="inline-flex items-center justify-center w-5 h-5 text-xs text-white bg-emerald-700 dark:bg-emerald-600 rounded-full">{{ request|get_parameter:'status'|tsplit:','|length }}</span>
                                                {% endif %}
                                            </div>
                                            <svg aria-hidden="true" data-accordion-icon="" class="w-5 h-5 rotate-180 shrink-0" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                                            </svg>
                                        </button>
                                    </h2>
                                    <div id="status-body" class="hidden" aria-labelledby="status-heading">
                                        <div class="py-2 font-light border-b border-gray-200 dark:border-gray-600">
                                            <ul class="space-y-2">
                                                {% get_choices "OrderStatusChoices" as OrderStatusChoices %}
                                                {% for item in OrderStatusChoices %}
                                                <li class="flex items-center">
                                                    <input id="status-{{ item.0 }}" {% check_get_parameter request 'status' item.1 %} onchange="updateUrlParameters('status', '{{ item.1 }}')" type="checkbox" value="{{ item.0 }}" class="cursor-pointer w-4 h-4 bg-gray-100 border-gray-300 rounded text-emerald-600 focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-700 focus:ring-2 dark:border-gray-500">
                                                    <label for="status-{{ item.0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100 w-full cursor-pointer">{{ item.1 }}</label>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                            <a href="javascript:void(0)" onclick="removeUrlParameters('status')" class="mt-2 flex items-center text-sm font-medium text-emerald-600 dark:text-emerald-500 hover:underline">Filterung aufheben</a>
                                        </div>
                                    </div>
                                    <!-- (Online) Rezeptstatus -->
                                    <h2 id="online-recipe-status-heading">
                                        <button type="button" class="flex items-center justify-between w-full py-2 px-1.5 text-sm font-medium text-left text-gray-500 border-b border-gray-200 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700" data-accordion-target="#online-recipe-status-body" aria-expanded="true" aria-controls="online-recipe-status-body">
                                            <div>
                                                <span class="mr-2">(Online) Rezeptstatus</span>
                                                {% if request|get_parameter:'online_recipe_status' %}
                                                <span class="inline-flex items-center justify-center w-5 h-5 text-xs text-white bg-emerald-700 dark:bg-emerald-600 rounded-full">{{ request|get_parameter:'online_recipe_status'|tsplit:','|length }}</span>
                                                {% endif %}
                                            </div>
                                            <svg aria-hidden="true" data-accordion-icon="" class="w-5 h-5 rotate-180 shrink-0" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                                            </svg>
                                        </button>
                                    </h2>
                                    <div id="online-recipe-status-body" class="hidden" aria-labelledby="online-recipe-status-heading">
                                        <div class="py-2 font-light border-b border-gray-200 dark:border-gray-600">
                                            <ul class="space-y-2">
                                                {% get_choices "OnlineRecipeStatusChoices" as OnlineRecipeStatusChoices %}
                                                {% for item in OnlineRecipeStatusChoices %}
                                                <li class="flex items-center">
                                                    <input id="online-recipe-status-{{ item.0 }}" {% check_get_parameter request 'online_recipe_status' item.1 %} onchange="updateUrlParameters('online_recipe_status', '{{ item.1 }}')" type="checkbox" value="{{ item.0 }}" class="cursor-pointer w-4 h-4 bg-gray-100 border-gray-300 rounded text-emerald-600 focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-700 focus:ring-2 dark:border-gray-500">
                                                    <label for="online-recipe-status-{{ item.0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100 w-full cursor-pointer">{{ item.1 }}</label>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                            <a href="javascript:void(0)" onclick="removeUrlParameters('online_recipe_status')" class="mt-2 flex items-center text-sm font-medium text-emerald-600 dark:text-emerald-500 hover:underline">Filterung aufheben</a>
                                        </div>
                                    </div>
                                    <!-- Original Rezeptstatus -->
                                    <h2 id="recipe-status-heading">
                                        <button type="button" class="flex items-center justify-between w-full py-2 px-1.5 text-sm font-medium text-left text-gray-500 border-b border-gray-200 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700" data-accordion-target="#recipe-status-body" aria-expanded="true" aria-controls="recipe-status-body">
                                            <div>
                                                <span class="mr-2">Original Rezeptstatus</span>
                                                {% if request|get_parameter:'recipe_status' %}
                                                <span class="inline-flex items-center justify-center w-5 h-5 text-xs text-white bg-emerald-700 dark:bg-emerald-600 rounded-full">{{ request|get_parameter:'recipe_status'|tsplit:','|length }}</span>
                                                {% endif %}
                                            </div>
                                            <svg aria-hidden="true" data-accordion-icon="" class="w-5 h-5 rotate-180 shrink-0" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                                            </svg>
                                        </button>
                                    </h2>
                                    <div id="recipe-status-body" class="hidden" aria-labelledby="recipe-status-heading">
                                        <div class="py-2 font-light border-b border-gray-200 dark:border-gray-600">
                                            <ul class="space-y-2">
                                                {% get_choices "RecipeStatusChoices" as RecipeStatusChoices %}
                                                {% for item in RecipeStatusChoices %}
                                                <li class="flex items-center">
                                                    <input id="recipe-status-{{ item.0 }}" {% check_get_parameter request 'recipe_status' item.1 %} onchange="updateUrlParameters('recipe_status', '{{ item.1 }}')" type="checkbox" value="{{ item.0 }}" class="cursor-pointer w-4 h-4 bg-gray-100 border-gray-300 rounded text-emerald-600 focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-700 focus:ring-2 dark:border-gray-500">
                                                    <label for="recipe-status-{{ item.0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100 w-full cursor-pointer">{{ item.1 }}</label>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                            <a href="javascript:void(0)" onclick="removeUrlParameters('recipe_status')" class="mt-2 flex items-center text-sm font-medium text-emerald-600 dark:text-emerald-500 hover:underline">Filterung aufheben</a>
                                        </div>
                                    </div>
                                    <!-- Bezahlstatus -->
                                    <h2 id="payment-status-heading">
                                        <button type="button" class="flex items-center justify-between w-full py-2 px-1.5 text-sm font-medium text-left text-gray-500 border-b border-gray-200 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700" data-accordion-target="#payment-status-body" aria-expanded="true" aria-controls="payment-status-body">
                                            <div>
                                                <span class="mr-2">Bezahlstatus</span>
                                                {% if request|get_parameter:'payment_status' %}
                                                <span class="inline-flex items-center justify-center w-5 h-5 text-xs text-white bg-emerald-700 dark:bg-emerald-600 rounded-full">{{ request|get_parameter:'payment_status'|tsplit:','|length }}</span>
                                                {% endif %}
                                            </div>
                                            <svg aria-hidden="true" data-accordion-icon="" class="w-5 h-5 rotate-180 shrink-0" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                                            </svg>
                                        </button>
                                    </h2>
                                    <div id="payment-status-body" class="hidden" aria-labelledby="payment-status-heading">
                                        <div class="py-2 font-light border-b border-gray-200 dark:border-gray-600">
                                            <ul class="space-y-2">
                                                {% get_choices "PaymentStatusChoices" as PaymentStatusChoices %}
                                                {% for item in PaymentStatusChoices %}
                                                <li class="flex items-center">
                                                    <input id="payment-status-{{ item.0 }}" {% check_get_parameter request 'payment_status' item.1 %} onchange="updateUrlParameters('payment_status', '{{ item.1 }}')" type="checkbox" value="{{ item.0 }}" class="cursor-pointer w-4 h-4 bg-gray-100 border-gray-300 rounded text-emerald-600 focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-700 focus:ring-2 dark:border-gray-500">
                                                    <label for="payment-status-{{ item.0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100 w-full cursor-pointer">{{ item.1 }}</label>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                            <a href="javascript:void(0)" onclick="removeUrlParameters('payment_status')" class="mt-2 flex items-center text-sm font-medium text-emerald-600 dark:text-emerald-500 hover:underline">Filterung aufheben</a>
                                        </div>
                                    </div>
                                    <!-- Versandart -->
                                    <h2 id="delivery-type-heading">
                                        <button type="button" class="flex items-center justify-between w-full py-2 px-1.5 text-sm font-medium text-left text-gray-500 border-b border-gray-200 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700" data-accordion-target="#delivery-type-body" aria-expanded="true" aria-controls="delivery-type-body">
                                            <div>
                                                <span class="mr-2">Versandart</span>
                                                {% if request|get_parameter:'delivery_type' %}
                                                <span class="inline-flex items-center justify-center w-5 h-5 text-xs text-white bg-emerald-700 dark:bg-emerald-600 rounded-full">{{ request|get_parameter:'delivery_type'|tsplit:','|length }}</span>
                                                {% endif %}
                                            </div>
                                            <svg aria-hidden="true" data-accordion-icon="" class="w-5 h-5 rotate-180 shrink-0" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                                            </svg>
                                        </button>
                                    </h2>
                                    <div id="delivery-type-body" class="hidden" aria-labelledby="delivery-type-heading">
                                        <div class="py-2 font-light border-b border-gray-200 dark:border-gray-600">
                                            <ul class="space-y-2">
                                                {% get_choices "DeliveryTypeChoices" as DeliveryTypeChoices %}
                                                {% for item in DeliveryTypeChoices %}
                                                <li class="flex items-center">
                                                    <input id="delivery-type-{{ item.0 }}" {% check_get_parameter request 'delivery_type' item.1 %} onchange="updateUrlParameters('delivery_type', '{{ item.1 }}')" type="checkbox" value="{{ item.0 }}" class="cursor-pointer w-4 h-4 bg-gray-100 border-gray-300 rounded text-emerald-600 focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-700 focus:ring-2 dark:border-gray-500">
                                                    <label for="delivery-type-{{ item.0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100 w-full cursor-pointer">{{ item.1 }}</label>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                            <a href="javascript:void(0)" onclick="removeUrlParameters('delivery_type')" class="mt-2 flex items-center text-sm font-medium text-emerald-600 dark:text-emerald-500 hover:underline">Filterung aufheben</a>
                                        </div>
                                    </div>
                                    <!-- Zahlungsmethode -->
                                    <h2 id="payment-type-heading">
                                        <button type="button" class="flex items-center justify-between w-full py-2 px-1.5 text-sm font-medium text-left text-gray-500 border-b border-gray-200 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700" data-accordion-target="#payment-type-body" aria-expanded="true" aria-controls="payment-type-body">
                                            <div>
                                                <span class="mr-2">Zahlungsmethode</span>
                                                {% if request|get_parameter:'payment_type' %}
                                                <span class="inline-flex items-center justify-center w-5 h-5 text-xs text-white bg-emerald-700 dark:bg-emerald-600 rounded-full">{{ request|get_parameter:'payment_type'|tsplit:','|length }}</span>
                                                {% endif %}
                                            </div>
                                            <svg aria-hidden="true" data-accordion-icon="" class="w-5 h-5 rotate-180 shrink-0" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                                            </svg>
                                        </button>
                                    </h2>
                                    <div id="payment-type-body" class="hidden" aria-labelledby="payment-type-heading">
                                        <div class="py-2 font-light border-b border-gray-200 dark:border-gray-600">
                                            <ul class="space-y-2">
                                                {% get_choices "PaymentTypeChoices" as PaymentTypeChoices %}
                                                {% for item in PaymentTypeChoices %}
                                                <li class="flex items-center">
                                                    <input id="payment-type-{{ item.0 }}" {% check_get_parameter request 'payment_type' item.1 %} onchange="updateUrlParameters('payment_type', '{{ item.1 }}')" type="checkbox" value="{{ item.0 }}" class="cursor-pointer w-4 h-4 bg-gray-100 border-gray-300 rounded text-emerald-600 focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-700 focus:ring-2 dark:border-gray-500">
                                                    <label for="payment-type-{{ item.0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100 w-full cursor-pointer">{{ item.1 }}</label>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                        <a href="javascript:void(0)" onclick="removeUrlParameters('payment_type')" class="mt-2 flex items-center text-sm font-medium text-emerald-600 dark:text-emerald-500 hover:underline">Filterung aufheben</a>
                                    </div>
                                    <!-- Rezeptart -->
                                    <h2 id="customer-type-heading">
                                        <button type="button" class="flex items-center justify-between w-full py-2 px-1.5 text-sm font-medium text-left text-gray-500 border-b border-gray-200 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700" data-accordion-target="#customer-type-body" aria-expanded="true" aria-controls="customer-type-body">
                                            <div>
                                                <span class="mr-2">Rezeptart</span>
                                                {% if request|get_parameter:'customer_type' %}
                                                <span class="inline-flex items-center justify-center w-5 h-5 text-xs text-white bg-emerald-700 dark:bg-emerald-600 rounded-full">{{ request|get_parameter:'customer_type'|tsplit:','|length }}</span>
                                                {% endif %}
                                            </div>
                                            <svg aria-hidden="true" data-accordion-icon="" class="w-5 h-5 rotate-180 shrink-0" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd" clip-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                                            </svg>
                                        </button>
                                    </h2>
                                    <div id="customer-type-body" class="hidden" aria-labelledby="customer-type-heading">
                                        <div class="py-2 font-light border-b border-gray-200 dark:border-gray-600">
                                            <ul class="space-y-2">
                                                {% get_choices "CustomerTypeChoices" as CustomerTypeChoices %}
                                                {% for item in CustomerTypeChoices %}
                                                <li class="flex items-center">
                                                    <input id="customer-type-{{ item.0 }}" {% check_get_parameter request 'customer_type' item.1 %} onchange="updateUrlParameters('customer_type', '{{ item.1 }}')" type="checkbox" value="{{ item.0 }}" class="cursor-pointer w-4 h-4 bg-gray-100 border-gray-300 rounded text-emerald-600 focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-700 focus:ring-2 dark:border-gray-500">
                                                    <label for="customer-type-{{ item.0 }}" class="ml-2 text-sm font-medium text-gray-900 dark:text-gray-100 w-full cursor-pointer">{{ item.1 }}</label>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                            <a href="javascript:void(0)" onclick="removeUrlParameters('customer_type')" class="mt-2 flex items-center text-sm font-medium text-emerald-600 dark:text-emerald-500 hover:underline">Filterung aufheben</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Aktionen -->
                            <div class="flex items-center space-x-3 w-full md:w-auto h-full">
                                <button id="actionsDropdownButton" disabled data-dropdown-toggle="actionsDropdown" class="w-full h-full md:w-auto flex items-center justify-center py-2 px-4 text-sm font-medium text-gray-500 focus:outline-none bg-white rounded-full border border-gray-200 hover:bg-gray-100 hover:text-emerald-700 focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:text-gray-400 dark:hover:text-white dark:hover:bg-gray-700" type="button">
                                    Aktionen
                                    <svg class="-mr-1 ml-1.5 w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                        <path clip-rule="evenodd" fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" />
                                    </svg>
                                </button>
                                <div id="actionsDropdown" class="hidden z-10 w-52 bg-white rounded divide-y divide-gray-100 shadow dark:divide-gray-600">
                                    <ul class="py-1 text-sm text-gray-700 dark:text-gray-200" aria-labelledby="actionsDropdownButton">
                                        {% if request.user.is_superuser %}
                                        <li>
                                            <a href="javascript:void(0)" onclick="updateAllDeliveryStatus()" class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Lieferstatus updaten</a>
                                        </li>
                                        {% endif %}
                                        <li>
                                            <a href="javascript:void(0)" onclick="sendOrderCreatedToCustomer()" class="block py-2 px-4 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Link zur Bestellbestätigung senden</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="table-container" style="flex: 1" class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:text-gray-400" style="position: -webkit-sticky;position: sticky;top: 0;z-index: 1;">
                                <tr>
                                    <th scope="col" class="p-4">
                                        <div class="flex items-center">
                                            <input id="checkbox-all" type="checkbox" class="w-4 h-4 text-emerald-600 bg-gray-100 rounded border-gray-300 focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-800 focus:ring-2 dark:border-gray-600">
                                            <label for="checkbox-all" class="sr-only">checkbox</label>
                                        </div>
                                    </th>
                                    <th scope="col" class="p-4">Kundenname</th>
                                    <th scope="col" class="p-4">Bestelldatum</th>
                                    <th scope="col" class="p-4">
                                        <div class="flex space-x-1 5 items-center">
                                            <p>Rezeptart</p>
                                            {% if request|get_parameter:'customer_type' %}
                                            <div>
                                                <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M5.05 3C3.291 3 2.352 5.024 3.51 6.317l5.422 6.059v4.874c0 .472.227.917.613 1.2l3.069 2.25c1.01.742 2.454.036 2.454-1.2v-7.124l5.422-6.059C21.647 5.024 20.708 3 18.95 3H5.05Z"></path>
                                                </svg>
                                            </div>
                                            {% endif %}
                                        </div>
                                    </th>
                                    <th scope="col" class="p-4">
                                        <div class="flex space-x-1 5 items-center">
                                            <p>Zahlungsmethode</p>
                                            {% if request|get_parameter:'payment_type' %}
                                            <div>
                                                <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M5.05 3C3.291 3 2.352 5.024 3.51 6.317l5.422 6.059v4.874c0 .472.227.917.613 1.2l3.069 2.25c1.01.742 2.454.036 2.454-1.2v-7.124l5.422-6.059C21.647 5.024 20.708 3 18.95 3H5.05Z"></path>
                                                </svg>
                                            </div>
                                            {% endif %}
                                        </div>
                                    </th>
                                    <th scope="col" class="p-4">
                                        <div class="flex space-x-1 5 items-center">
                                            <p>Versandart</p>
                                            {% if request|get_parameter:'delivery_type' %}
                                            <div>
                                                <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M5.05 3C3.291 3 2.352 5.024 3.51 6.317l5.422 6.059v4.874c0 .472.227.917.613 1.2l3.069 2.25c1.01.742 2.454.036 2.454-1.2v-7.124l5.422-6.059C21.647 5.024 20.708 3 18.95 3H5.05Z"></path>
                                                </svg>
                                            </div>
                                            {% endif %}
                                        </div>
                                    </th>
                                    <th scope="col" class="p-4">Bestellwert</th>
                                    <th scope="col" class="p-4">Rezeptnummer</th>
                                    <th scope="col" class="p-4">Artikelanzahl</th>
                                    <th scope="col" class="p-0 sticky right-0">
                                        <div class="p-4 bg-gray-50 flex h-full w-full" style="height: 64.5px;">
                                            <span class="my-auto">Update</span>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for order in orders %}
                                <tr id="order-{{ order.id }}" data-order-id="{{ order.id }}" class="orders border-t *:hover:bg-gray-100 *:dark:hover:bg-gray-600 order {% if order.payment_status == 'overdue' %}overdue{% endif %} {% if order.status == 'started' %}order-started{% endif %}">
                                    <!-- Checkbox -->
                                    <td class="pl-4 pr-2 py-3 w-4 relative">
                                        <div class="flex items-center">
                                            <input id="order-checkbox-{{ order.id }}" value="{{ order.id }}" type="checkbox" onclick="event.stopPropagation()" class="order-checkbox w-4 h-4 text-emerald-600 bg-gray-100 rounded border-gray-300 focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-800 focus:ring-2 dark:border-gray-600">
                                            <label for="order-checkbox-{{ order.id }}" class="sr-only">checkbox</label>
                                        </div>
                                    </td>
                                    <!-- Kundeninformationen -->
                                    <td class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap">
                                        <div hidden>
                                            <div data-name="popover-content-{{ order.id }}">
                                                <p class="text-gray-500 dark:text-gray-400" name="customerId">Kunden-Nr.: {{ order.customer.id }}</p>
                                                <p class="text-gray-500 dark:text-gray-400">
                                                    <span name="street">{{ order.street }}</span> <span name="streetNumber">{{ order.street_number }}</span><br>
                                                    <span name="postalcode">{{ order.postalcode }}</span> <span name="city">{{ order.city }}</span>
                                                </p>
                                            </div>
                                        </div>
                                        <a id="customer{{ order.id }}" tabindex="0" class="btn btn-lg btn-danger flex" data-bs-trigger="focus" data-bs-placement="top" data-bs-custom-class="custom-popover" role="button" data-bs-toggle="popover" title="{{ order.first_name }} {{ order.last_name }}" >
                                            <span name="customerName">{{ order.first_name }} {{ order.last_name }}</span>
                                            <svg style="margin-top: 2px;" class="ml-3 mt-0 w-4 h-4 text-gray-400 hover:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9h2v5m-2 0h4M9.408 5.5h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                                            </svg>
                                        </a>
                                    </td>
                                    <!-- Bestellzeit -->
                                    <td class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap" name="orderDate">{{ order.order_time|date:'d.m.Y' }}</td>
                                    <!-- Rezeptart -->
                                    <td class="px-4 py-3">
                                        <span style="white-space: nowrap;"
                                            class="text-xs font-medium px-2 py-0.5 rounded
                                            {% if order.customer_type == 'self_payer' %}
                                            bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-300
                                            {% elif order.customer_type == 'insurance_patient' %}
                                            bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300
                                            {% elif order.customer_type == 'insurance_patient_with_supplement' %}
                                            bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-300
                                            {% endif %}
                                            "
                                            value="{{ order.customer_type }}">
                                                {{ order.get_customer_type_display }}
                                        </span>
                                    </td>
                                    <!-- Bezahlmethode -->
                                    <td class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap">{{ order.get_payment_type_display }}</td>
                                    <!-- Versandart -->
                                    <td class="px-4 py-3">
                                        <span style="white-space: nowrap;"
                                            class="text-xs font-medium px-2 py-0.5 rounded
                                            {% if order.delivery_type == 'pickup' %}
                                            bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-300
                                            {% elif order.delivery_type == 'dhl_standard' %}
                                            bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300
                                            {% elif order.delivery_type == 'go_express' %}
                                            bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300
                                            {% endif %}
                                            "
                                            value="{{ order.delivery_type }}">
                                                {{ order.get_delivery_type_display }}
                                        </span>
                                    </td>
                                    <!-- Betrag -->
                                    <td class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap" name="total">{{ order.total|to_euro_decimal }} €</td>
                                    <!-- Rezeptnummer -->
                                    <td class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap">
                                        {% for recipe in order|get_recipes %}
                                        <a href="{{ recipe.file.url }}" target="_blank">{{ recipe.number }}</a>
                                        {% endfor %}
                                    </td>
                                    <!-- Anzahl produkte -->
                                    <td class="px-4 py-3 font-medium text-gray-900 whitespace-nowrap" name="orderAmount">{{ order|get_order_products|length }}</td>
                                    <!-- Edit Button -->
                                    <td class="p-0 font-medium text-gray-900 whitespace-nowrap sticky right-0 bg-white dark:bg-gray-800">
                                        <div class="px-4 py-3">
                                            <div class="flex items-center space-x-4">
                                                <button type="button" onclick="getOrderDetails('{{ order.id }}')" id="createProductButton" class="flex items-center justify-center text-white bg-emerald-700 hover:bg-emerald-700 focus:ring-4 focus:ring-emerald-300 font-medium rounded-full text-sm px-4 py-2 dark:bg-emerald-600 dark:hover:bg-emerald-700 focus:outline-none dark:focus:ring-emerald-800">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 -ml-0.5" viewbox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                                        <path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" />
                                                        <path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" />
                                                    </svg>
                                                    Edit
                                                </button>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <nav class="flex flex-col md:flex-row justify-between items-start md:items-center space-y-3 md:space-y-0 p-4 border-gray-600 border-t" aria-label="Table navigation">
                        <ul class="inline-flex items-stretch -space-x-px">
                            {% with orders.paginator.page_range|first as first_page %}
                            {% with 'page:'|concat_string:first_page as page_string %}
                            {% with updated_params=request.GET|add_get_parameter:page_string %}
                            <li>
                                <a href="?{{ updated_params }}" class="flex items-center justify-center h-full py-1.5 px-3 ml-0 text-gray-500 bg-white rounded-l-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">
                                    <span class="sr-only">Erste Seite</span>
                                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" viewBox="0 0 12 10">
                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M5 1 1 5l4 4m6-8L7 5l4 4"/>
                                    </svg>
                                </a>
                            </li>
                            {% endwith %}
                            {% endwith %}
                            {% endwith %}
                            {% for page_num in orders.paginator.page_range|get_page_range:orders.number %}
                            {% if orders.number == page_num %}
                            <li>
                                <a href="?{{ updated_params }}" aria-current="page" class="flex items-center justify-center text-sm z-10 py-2 px-3 leading-tight text-emerald-600 bg-emerald-50 border border-emerald-300 hover:bg-emerald-100 hover:text-emerald-700 dark:border-gray-700">{{ page_num }}</a>
                            </li>
                            {% else %}
                            {% with 'page:'|concat_string:page_num as page_string %}
                            {% with updated_params=request.GET|add_get_parameter:page_string %}
                            <li>
                                <a href="?{{ updated_params }}" class="flex items-center justify-center text-sm py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">{{ page_num }}</a>
                            </li>
                            {% endwith %}
                            {% endwith %}
                            {% endif %}
                            {% endfor %}
                            {% with orders.paginator.page_range|last as last_page %}
                            {% with 'page:'|concat_string:last_page as page_string %}
                            {% with updated_params=request.GET|add_get_parameter:page_string %}
                            <li>
                                <a href="?{{ updated_params }}" class="flex items-center justify-center h-full py-1.5 px-3 leading-tight text-gray-500 bg-white rounded-r-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">
                                    <span class="sr-only">Letzte Seite</span>
                                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" viewBox="0 0 12 10">
                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="m7 9 4-4-4-4M1 9l4-4-4-4"/>
                                    </svg>
                                </a>
                            </li>
                            {% endwith %}
                            {% endwith %}
                            {% endwith %}
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- End block -->

<div id="identCheck" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] md:h-full">
    <div class="relative w-full h-full md:h-auto" style="max-width: 75vw;max-height: 80vh;overflow-y: auto;">
        <!-- Modal content -->
        <div class="relative p-4 bg-white rounded-full shadow sm:p-5">
            <!-- Modal header -->
            <div class="flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600">
                <h3 class="text-lg font-semibold text-gray-900">Ident Check für Kauf auf Rechnung</h3>
                <button type="button" onclick="hideModal('identCheck')" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white">
                    <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <!-- Modal body -->
            <div class="mb-5">
                <h3 class="text-lg font-semibold text-gray-900">Bitte überprüfe die Daten der Bestellung mit den Daten auf dem Ausweisdokument sorgfältig!</h3>
                <div class="flex pt-4 gap-4">
                    <div class="left-container ident-check-images">
                    </div>
                    <div class="right-container flex-1">
                        <form class="pt-5" id="identCheckDetailsForm">
                            <input type="text" name="orderId" hidden>
                            <div class="flex mb-2">
                                <div class="grid gap-4 mb-4 sm:grid-cols-3 flex-1">
                                    <div>
                                        <label for="orderNumber" class="block mb-2 text-sm font-medium text-gray-900">Bestellnummer</label>
                                        <input type="text" aria-label="disabled input" name="orderNumber" class="mb-6 bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 cursor-not-allowed dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" disabled>
                                    </div>
                                    <div>
                                        <label for="identNumber" class="block mb-2 text-sm font-medium text-gray-900">Ausweisnummer</label>
                                        <input type="text" aria-label="disabled input" name="identNumber" class="mb-6 bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 cursor-not-allowed dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" disabled>
                                    </div>
                                </div>
                                <div class="ms-4">
                                    <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900">Check</label>
                                    <input id="identCheck1" type="checkbox" value="" name="identCheckCheckbox" style="padding: 1.24rem;" class="mb-6 w-4 h-4 text-emerald-600 bg-gray-100 border-gray-300 rounded-full focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-800 focus:ring-2 dark:border-gray-600">
                                </div>
                            </div>
                            <div class="flex mb-2">
                                <div class="grid gap-4 mb-4 sm:grid-cols-3 flex-1">
                                    <div>
                                        <label for="salutation" class="block mb-2 text-sm font-medium text-gray-900">Anrede</label>
                                        <select disabled id="salutation" name="salutation" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                            {% get_choices "SalutationChoices" as SalutationChoices %}
                                            {% for item in SalutationChoices %}
                                            <option value="{{ item.0 }}">{{ item.1 }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div>
                                        <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900">Vorname</label>
                                        <input type="text" aria-label="disabled input" name="firstName" class="mb-6 bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 cursor-not-allowed dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" disabled>
                                        <!-- <input aria-label="disabled" disabled readonly type="text" name="firstName" id="first_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Vorname" required=""> -->
                                    </div>
                                    <div>
                                        <label for="last_name" class="block mb-2 text-sm font-medium text-gray-900">Nachname</label>          
                                        <input type="text" aria-label="disabled input" name="lastName" class="mb-6 bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 cursor-not-allowed dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" disabled>
                                        <!-- <input disabled readonly type="text" name="lastName" id="last_name" class="disabled bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Nachname" required=""> -->
                                    </div>
                                </div>
                                <div class="ms-4">
                                    <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900">Check</label>
                                    <input id="identCheck2" type="checkbox" value="" name="identCheckCheckbox" style="padding: 1.24rem;" class="mb-6 w-4 h-4 text-emerald-600 bg-gray-100 border-gray-300 rounded-full focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-800 focus:ring-2 dark:border-gray-600">
                                </div>
                            </div>
                            <div class="flex mb-2">
                                <div class="grid gap-4 mb-4 sm:grid-cols-4 flex-1">
                                    <div>
                                        <label for="street" class="block mb-2 text-sm font-medium text-gray-900">Straße</label>
                                        <input type="text" aria-label="disabled input" name="street" class="mb-6 bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 cursor-not-allowed dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" disabled>
                                        <!-- <input aria-label="disabled" disabled readonly type="text" name="firstName" id="first_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Vorname" required=""> -->
                                    </div>
                                    <div>
                                        <label for="streetNumber" class="block mb-2 text-sm font-medium text-gray-900">Straßennummer</label>          
                                        <input type="text" aria-label="disabled input" name="streetNumber" class="mb-6 bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 cursor-not-allowed dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" disabled>
                                        <!-- <input disabled readonly type="text" name="lastName" id="last_name" class="disabled bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Nachname" required=""> -->
                                    </div>
                                    <div>
                                        <label for="postalcode" class="block mb-2 text-sm font-medium text-gray-900">Postleitzahl</label>          
                                        <input type="text" aria-label="disabled input" name="postalcode" class="mb-6 bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 cursor-not-allowed dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" disabled>
                                        <!-- <input disabled readonly type="text" name="lastName" id="last_name" class="disabled bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Nachname" required=""> -->
                                    </div>
                                    <div>
                                        <label for="city" class="block mb-2 text-sm font-medium text-gray-900">Postleitzahl</label>          
                                        <input type="text" aria-label="disabled input" name="city" class="mb-6 bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 cursor-not-allowed dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" disabled>
                                        <!-- <input disabled readonly type="text" name="lastName" id="last_name" class="disabled bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Nachname" required=""> -->
                                    </div>
                                </div>
                                <div class="ms-4">
                                    <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900">Check</label>
                                    <input id="identCheck3" type="checkbox" value="" name="identCheckCheckbox" style="padding: 1.24rem;" class="mb-6 w-4 h-4 text-emerald-600 bg-gray-100 border-gray-300 rounded-full focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-800 focus:ring-2 dark:border-gray-600">
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="d-flex justify-between pt-4 sm:flex sm:space-y-0 sm:space-x-4">
                <div class="mb-4 sm:mb-0 items-center d-flex space-y-4 sm:flex sm:space-y-0 sm:space-x-4">
                    <button disabled id="completeIdentCheck" type="button" onclick="completeIdentCheck('{{ order.id }}')" data-toast-name="orderUpdatedToast" type="submit" class="w-full sm:w-auto justify-center text-white inline-flex bg-emerald-700 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:bg-emerald-600 dark:hover:bg-emerald-700 dark:focus:ring-emerald-800">
                        Speichern
                    </button>
                    <button onclick="hideModal('identCheck')" type="button" class="w-full justify-center sm:w-auto text-gray-500 inline-flex items-center bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-emerald-300 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                        <svg class="mr-1 -ml-1 w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                        Abbrechen
                    </button>
                    
                </div>
                <hr class="block sm:none border border-gray-300 dark:border-gray-600">
                <button onclick="toggleStornoModal()" type="button" class="mt-4 mt-sm-0 w-full sm:w-auto text-white justify-center inline-flex items-center bg-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-800">
                    <svg class="mr-1 -ml-1 w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                    Stornieren
                </button>
            </div>
            
        </div>
    </div>
</div>

<div id="importOrder" tabindex="-1" aria-hidden="true" class="modal-parent-div hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] md:h-full">
    <div class="relative w-full h-full md:h-auto" style="max-width: 75vw;max-height: 80vh;overflow-y: auto;">
        <!-- Modal content -->
        <div class="relative p-4 bg-white rounded-full shadow sm:p-5">
            <!-- Modal header -->
            <div class="flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600">
                <h3 class="text-lg font-semibold text-gray-900">Bestellung importieren</h3>
                <button type="button" onclick="hideModal('importOrder')" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white">
                    <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <!-- Modal body -->
            <div class="mb-5">
                <form id="importOrderForm">
                    <div class="flex pt-4 gap-4">
                        <div class="ident-check-images flex flex-row gap-4">
                            <div class="mb-2 flex flex-col">
                                <textarea class="mb-2" id="htmlInputForImport" rows="10" cols="50" placeholder="Füge hier den HTML-Code der E-Mail ein"></textarea>
                                <button id="" type="button" onclick="extractData()"  type="submit" class="w-full sm:w-auto justify-center text-white inline-flex bg-emerald-700 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:bg-emerald-600 dark:hover:bg-emerald-700 dark:focus:ring-emerald-800">
                                    Daten extrahieren
                                </button>
                            </div>
                        </div>
                        <div class="right-container flex-1" style="border-left: 1px solid #4b5563; padding-left: 1rem;">
                            <!-- Hochladen -->
                            <div class="mt-4 flex flex-col gap-4 mb-5">
                                <div class="mr-auto w-96">
                                    <label class="block mb-2 text-sm font-medium text-gray-900" for="recipeFile">Rezept hochladen</label>
                                    <input class="block w-full text-sm text-gray-900 border border-gray-300 rounded-full cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:placeholder-gray-400" aria-describedby="file_input_help" id="recipeFile" name="recipeFile" type="file">
                                    <p class="mt-1 text-sm text-gray-500 dark:text-gray-300">PDF, PNG oder JPG.</p>
                                </div>
                                <div class="me-auto w-96">
                                    <label for="onlineRecipeStatus" class="inline-flex items-center mb-2 text-sm font-medium text-gray-900">
                                        Online Rezeptstatus
                                    </label>
                                    <select id="onlineRecipeStatus" name="onlineRecipeStatus" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                        {% get_choices "OnlineRecipeStatusChoices" as OnlineRecipeStatusChoices %}
                                        {% for item in OnlineRecipeStatusChoices %}
                                        <option value="{{ item.0 }}">{{ item.1 }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <table hidden>
                                <tbody>
                                    <tr>
                                        <td class="text-md font-semibold text-gray-900 dark:text-gray-400">Name:</td>
                                        <td><span id="extractedName" class="text-md font-semibold text-gray-900 ms-2 ps-2"></span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-md font-semibold text-gray-900 dark:text-gray-400">Straße / Hausnummer:</td>
                                        <td><span id="extractedAddress" class="text-md font-semibold text-gray-900 ms-2 ps-2"></span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-md font-semibold text-gray-900 dark:text-gray-400">PLZ/Ort:</td>
                                        <td><span id="extractedCity" class="text-md font-semibold text-gray-900 ms-2 ps-2"></span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-md font-semibold text-gray-900 dark:text-gray-400">E-Mail Adresse:</td>
                                        <td><span id="extractedEmail" class="text-md font-semibold text-gray-900 ms-2 ps-2"></span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-md font-semibold text-gray-900 dark:text-gray-400">Telefon:</td>
                                        <td><span id="extractedPhone" class="text-md font-semibold text-gray-900 ms-2 ps-2"></span></td>
                                    </tr>
                                    <tr>
                                        <td class="text-md font-semibold text-gray-900 dark:text-gray-400">Geburtstag:</td>
                                        <td><span id="extractedBirthDate" class="text-md font-semibold text-gray-900 ms-2 ps-2"></span></td>
                                    </tr>
                                </tbody>
                            </table>

                            <div hidden class="mt-4 mb-1">
                                <span class="mt-4 mb-3 text-md font-semibold text-gray-900 dark:text-gray-400">Bestellte Produkte:</span>
                            </div>
                            <div hidden>
                                <table id="extractedOrderTable" style="width: 100%;">
                                    <thead>
                                        <tr>
                                            <th><span class="pt-4 pb-3 text-md font-semibold text-gray-900 dark:text-gray-400 text-left">Sorte</span></th>
                                            <th><span class="pt-4 pb-3 text-md font-semibold text-gray-900 dark:text-gray-400">Kultivar</span></th>
                                            <th><span class="pt-4 pb-3 text-md font-semibold text-gray-900 dark:text-gray-400">Zerkleinert</span></th>
                                            <th><span class="pt-4 pb-3 text-md font-semibold text-gray-900 dark:text-gray-400">Menge</span></th>
                                        </tr>
                                    </thead>
                                    <tbody id="extractedOrderedProducts">
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <div id="update-product-accordion-collapse-body-1-customer" aria-labelledby="update-product-accordion-collapse-heading-2">
                <div class="py-4 border-gray-200 sm:py-5 dark:border-gray-700">
                    <!-- Inputs -->
                        <!-- Column -->
                        <div class="">
                            <div class="grid gap-4 mb-4 sm:grid-cols-3">
                                <!-- Salutation -->
                                <div>
                                    <label for="salutation" class="block mb-2 text-sm font-medium text-gray-900">Anrede</label>
                                    <select id="extracted_salutation" name="salutation" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                        {% get_choices "SalutationChoices" as SalutationChoices %}
                                        {% for item in SalutationChoices %}
                                        <option value="{{ item.0 }}">{{ item.1 }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div></div>
                                <div>
                                    <label for="external_id" class="block mb-2 text-sm font-medium text-gray-900">Externe Bestell-ID</label>
                                    <input type="text" name="external_id" id="extracted_external_order_id" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Externe Bestell-ID" required="" readonly>
                                </div>
                            </div>
                            <div class="grid gap-4 mb-4 sm:grid-cols-3">
                                <!-- Vorname -->
                                <div>
                                    <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900">Vorname</label>
                                    <input type="text" name="firstName" id="extracted_first_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Vorname" required="">
                                </div>
                                <!-- Nachname -->
                                <div>
                                    <label for="last_name" class="block mb-2 text-sm font-medium text-gray-900">Nachname</label>
                                    <input type="text" name="lastName" id="extracted_last_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Nachname" required="">
                                </div>
                                <!-- Geburtsdatum -->
                                <div class="relative max-w-sm">
                                    <label for="birth_date" class="block mb-2 text-sm font-medium text-gray-900">Geburtsdatum</label>
                                    <div class="relative">
                                        <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                            <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                                <path d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"/>
                                            </svg>
                                        </div>
                                        <input datepicker datepicker-format="dd.mm.yyyy" type="text" id="extracted_birth_date" name="birthDate" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full ps-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Geburtsdatum">
                                    </div>
                                </div>
                            </div>
                            <div class="grid gap-4 mb-4 sm:grid-cols-3">
                                <!-- Straße -->
                                <div>
                                    <label for="street" class="block mb-2 text-sm font-medium text-gray-900">Straße</label>
                                    <input type="text" name="street" id="extracted_street" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Straße" required="">
                                </div>
                                <!-- Hausnummer -->
                                <div>
                                    <label for="street_number" class="block mb-2 text-sm font-medium text-gray-900">Hausnummer</label>
                                    <input type="text" name="streetNumber" id="extracted_street_number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Hausnummer" required="">
                                </div>
                                <!-- PLZ -->
                                <div>
                                    <label for="postalcode" class="block mb-2 text-sm font-medium text-gray-900">Postleitzahl</label>
                                    <input type="text" name="postalcode" id="extracted_postalcode" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Postleitzahl" required="">
                                </div>
                            </div>
                            <div class="grid gap-4 mb-4 sm:grid-cols-2">
                                <!-- Stadt -->
                                <div>
                                    <label for="city" class="block mb-2 text-sm font-medium text-gray-900">Stadt</label>
                                    <input type="text" name="city" id="extracted_city" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Stadt" required="">
                                </div>
                                <!-- Land -->
                                <div>
                                    <label for="country" class="block mb-2 text-sm font-medium text-gray-900">Land</label>
                                    <select id="country" name="country" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                        {% get_choices "CountryChoices" as countries %}
                                        {% for item in countries %}
                                        <option value="{{item.0}}" {% if order.country == item.0 %}selected{% endif %}>{{ item.1 }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <!-- Telefonnummer -->
                                <div>
                                    <label for="phone_number" class="block mb-2 text-sm font-medium text-gray-900">Telefonnummer</label>
                                    <input type="text" name="phonenumber" id="extracted_phone_number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Telefonnummer" required="">
                                </div>
                                <!-- E-Mail -->
                                <div>
                                    <label for="email_address" class="block mb-2 text-sm font-medium text-gray-900">E-Mail Adresse</label>
                                    <input type="email" name="email" id="extracted_email_address" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="E-Mail Adresse" required="">
                                </div>
                                <!-- Kommentar -->
                                <div class="sm:col-span-2">
                                    <label for="comment" class="block mb-2 text-sm font-medium text-gray-900">Kommentar</label>
                                    <textarea id="comment" name="comment" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-full border border-gray-300 focus:ring-emerald-500 focus:border-emerald-500 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Kommentar"></textarea>
                                </div>
                            </div>
                        </div>
                </div>
            </div>

            <span class="mt-4 mb-3 text-md font-semibold text-gray-900">Bestellte Produkte:</span>

            <h3 id="no-products-found-text" class="hidden mt-4 text-md font-semibold text-red-600 dark:red-600">Ein oder mehrere Produkte konnten nicht gefunden werden. Bitte überprüfen und erneut versuchen.</h3>

            <!-- Suche -->
            <div class="grid gap-4 sm:grid-cols-2">
                <div class="relative searchProductContainer mt-5">
                    <div class="absolute inset-y-0 start-0 flex items-center ps-4 pointer-events-none">
                        <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12.013 6.175 7.006 9.369l5.007 3.194-5.007 3.193L2 12.545l5.006-3.193L2 6.175l5.006-3.194 5.007 3.194ZM6.981 17.806l5.006-3.193 5.006 3.193L11.987 21l-5.006-3.194Z"/>
                            <path d="m12.013 12.545 5.006-3.194-5.006-3.176 4.98-3.194L22 6.175l-5.007 3.194L22 12.562l-5.007 3.194-4.98-3.211Z"/>
                        </svg>
                    </div>
                    <input type="text" id="searchProduct" dropdown-max-height="250" data-search-type="import-order-search-product" class="searchProductInput bg-gray-50 border w-full border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block ps-10 p-2 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Produktsuche" required>
                </div>
            </div>

            <!-- Produktliste -->
            <div id="update-product-accordion-collapse-body-4-2" aria-labelledby="update-product-accordion-collapse-heading-3" class="mb-4">
                <div class="border-gray-200 dark:border-gray-700">
                    <div id="extractedOrderedProductList" class="flex flex-col gap-4">
                        <!-- Bestelltes Produkt: ID xxx -->
                        <div></div>
                    </div>
                </div>
            </div>

            <h2 id="order-already-exists" class="hidden mt-4 text-md font-semibold text-red-600 dark:red-600">Bestellung existiert bereits. Bitte überprüfen.</h2>
            <h2 id="order-receipt-missing" class="hidden mt-4 text-md font-semibold text-red-600 dark:red-600">Bitte Rezept anhängen.</h2>

            <h3 class="pt-5 text-md font-semibold text-gray-900">Bitte überprüfe die Daten vor dem Speichern sorgfältig! Achte ebenfalls auf die Anrede.</h3>

            <div class="d-flex justify-between pt-4 sm:flex sm:space-y-0 sm:space-x-4">
                <div class="mb-4 sm:mb-0 items-center d-flex space-y-4 sm:flex sm:space-y-0 sm:space-x-4">
                    <button disabled id="sendExtractedData" type="button" onclick="sendExtractedData()" data-toast-name="orderUpdatedToast" type="submit" class="w-full sm:w-auto justify-center text-white inline-flex bg-emerald-700 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:bg-emerald-600 dark:hover:bg-emerald-700 dark:focus:ring-emerald-800">
                        Speichern
                    </button>
                    <button onclick="hideModal('importOrder')" type="button" class="w-full justify-center sm:w-auto text-gray-500 inline-flex items-center bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-emerald-300 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                        <svg class="mr-1 -ml-1 w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                        </svg>
                        Abbrechen
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Order Modal -->
<div id="orderModal" tabindex="-1" data-modal-backdrop="static" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] md:h-full">
    <div class="relative w-full h-full md:h-auto" style="max-width: 75vw;max-height: 80vh;overflow-y: auto;">
        <!-- Modal content -->
        <div class="relative p-4 bg-white rounded-full shadow sm:p-5">
            <!-- Modal header -->
            <div class="flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600">
                <h3 class="text-lg font-semibold text-gray-900">Bestellung anlegen</h3>
                <button type="button" onclick="hideModal('orderModal')" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white">
                    <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <!-- Modal body -->
            
            <form class="pt-5" id="orderDetailsForm">
                <div>
                    <!-- <h5 class="mb-4 text-lg font-semibold tracking-tight text-gray-900">
                        Bestelldaten
                    </h5> -->
                    <div class="grid gap-4 mb-5 sm:grid-cols-5">
                        <!-- Patientenart -->
                        <div class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                            <p class="mb-2 text-sm font-medium text-gray-900">
                                Patientenart
                            </p>
                            <select name="customerType" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                <option value="">Bitte wählen</option>
                                {% get_choices "CustomerTypeChoices" as CustomerTypeChoices %}
                                {% for item in CustomerTypeChoices %}
                                <option value="{{ item.0 }}">{{ item.1 }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <!-- Zahlungsmethode -->
                        <div class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                            <p class="mb-2 text-sm font-medium text-gray-900">
                                Zahlungsmethode
                            </p>
                            <select name="paymentType" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                <option value="">Bitte wählen</option>
                                {% get_choices "PaymentTypeChoices" as PaymentTypeChoices %}
                                {% for item in PaymentTypeChoices %}
                                <option value="{{ item.0 }}">{{ item.1 }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <!-- Liefermethode -->
                        <div class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                            <p class="mb-2 text-sm font-medium text-gray-900">
                                Liefermethode
                            </p>
                            <select name="deliveryType" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                <option value="">Bitte wählen</option>
                                {% get_choices "DeliveryTypeChoices" as DeliveryTypeChoices %}
                                {% for item in DeliveryTypeChoices %}
                                <option value="{{ item.0 }}">{{ item.1 }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <!-- Rezeptstatus -->
                        <div class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                            <p class="mb-2 text-sm font-medium text-gray-900">
                                Rezeptstatus
                            </p>
                            <select name="recipeStatus" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                <option value="">Bitte wählen</option>
                                {% get_choices "RecipeStatusChoices" as RecipeStatusChoices %}
                                {% for item in RecipeStatusChoices %}
                                {% if item.0 != 'incorrect' %}
                                <option value="{{ item.0 }}" {% if item.0 == 'checked' %}selected{% endif %}>{{ item.1 }}</option>
                                {% endif %}
                                {% endfor %}
                            </select>
                        </div>
                        <!-- Bestellsumme -->
                        <div class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                            <p class="mb-2 text-sm font-medium text-gray-900">
                                Bestellsumme
                            </p>
                            <span id="orderAmount" name="orderAmount" class="mb-4 text-sm font-medium text-gray-900 dark:text-gray-300">0,00 €</span>
                        </div>
                    </div>
                </div>
                <input type="text" name="orderId" hidden>
                <div id="accordion-collapse" data-accordion="collapse">
                    <!-- Bestelldaten -->
                    <h2 id="update-product-accordion-collapse-heading-1" style="margin: 0 -1.25rem; width: calc(100% + 2.5rem);">
                        <button type="button" id="invoiceDataButton" class="modal-accordion-button flex items-center justify-between w-full px-4 py-4 font-medium leading-none text-left text-gray-900 border-t border-gray-200 sm:px-5 bg-gray-50 hover:bg-gray-100 dark:hover:bg-gray-600" data-accordion-target="#update-product-accordion-collapse-body-1" aria-expanded="true" aria-controls="update-product-accordion-collapse-body-2">
                            <span>Bestelldaten</span>
                            <svg aria-hidden="true" data-accordion-icon="" class="w-6 h-6 rotate-180 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                        </button>
                    </h2>
                    <div id="update-product-accordion-collapse-body-1" class="hidden" aria-labelledby="update-product-accordion-collapse-heading-2">
                        <div class="py-4 border-gray-200 sm:py-5 dark:border-gray-700">
                            <!-- Inputs -->
                                <!-- Column -->
                                <div class="">
                                    <div class="grid gap-4 mb-4 sm:grid-cols-3">
                                        <!-- Salutation -->
                                        <div>
                                            <label for="salutation" class="block mb-2 text-sm font-medium text-gray-900">Anrede</label>
                                            <select id="salutation" name="salutation" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                                {% get_choices "SalutationChoices" as SalutationChoices %}
                                                {% for item in SalutationChoices %}
                                                <option value="{{ item.0 }}">{{ item.1 }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                    <div class="grid gap-4 mb-4 sm:grid-cols-3">
                                        <!-- Vorname -->
                                        <div>
                                            <label for="first_name" class="block mb-2 text-sm font-medium text-gray-900">Vorname</label>
                                            <input type="text" name="firstName" id="first_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Vorname" required="">
                                        </div>
                                        <!-- Nachname -->
                                        <div>
                                            <label for="last_name" class="block mb-2 text-sm font-medium text-gray-900">Nachname</label>
                                            <input type="text" name="lastName" id="last_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Nachname" required="">
                                        </div>
                                        <!-- Geburtsdatum -->
                                        <div class="relative max-w-sm">
                                            <label for="birth_date" class="block mb-2 text-sm font-medium text-gray-900">Geburtsdatum</label>
                                            <div class="relative">
                                                <div class="absolute inset-y-0 start-0 flex items-center ps-3.5 pointer-events-none">
                                                    <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"/>
                                                    </svg>
                                                </div>
                                                <input datepicker datepicker-format="dd.mm.yyyy" type="text" id="birth_date" name="birthDate" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full ps-10 p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Geburtsdatum">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="grid gap-4 mb-4 sm:grid-cols-3">
                                        <!-- Straße -->
                                        <div>
                                            <label for="street" class="block mb-2 text-sm font-medium text-gray-900">Straße</label>
                                            <input type="text" name="street" id="street" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Straße" required="">
                                        </div>
                                        <!-- Hausnummer -->
                                        <div>
                                            <label for="street_number" class="block mb-2 text-sm font-medium text-gray-900">Hausnummer</label>
                                            <input type="text" name="streetNumber" id="street_number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Hausnummer" required="">
                                        </div>
                                        <!-- PLZ -->
                                        <div>
                                            <label for="postalcode" class="block mb-2 text-sm font-medium text-gray-900">Postleitzahl</label>
                                            <input type="text" name="postalcode" id="postalcode" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Postleitzahl" required="">
                                        </div>
                                    </div>
                                    <div class="grid gap-4 mb-4 sm:grid-cols-2">
                                        <!-- Stadt -->
                                        <div>
                                            <label for="city" class="block mb-2 text-sm font-medium text-gray-900">Stadt</label>
                                            <input type="text" name="city" id="city" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Stadt" required="">
                                        </div>
                                        <!-- Land -->
                                        <div>
                                            <label for="country" class="block mb-2 text-sm font-medium text-gray-900">Land</label>
                                            <select id="country" name="country" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                                {% get_choices "CountryChoices" as countries %}
                                                {% for item in countries %}
                                                <option value="{{item.0}}" {% if order.country == item.0 %}selected{% endif %}>{{ item.1 }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <!-- Telefonnummer -->
                                        <div>
                                            <label for="phone_number" class="block mb-2 text-sm font-medium text-gray-900">Telefonnummer</label>
                                            <input type="text" name="phonenumber" id="phone_number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Telefonnummer" required="">
                                        </div>
                                        <!-- E-Mail -->
                                        <div>
                                            <label for="email_address" class="block mb-2 text-sm font-medium text-gray-900">E-Mail Adresse</label>
                                            <input type="email" name="email" id="email_address" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="E-Mail Adresse" required="">
                                        </div>
                                        <!-- Kommentar -->
                                        <div class="sm:col-span-2">
                                            <label for="comment" class="block mb-2 text-sm font-medium text-gray-900">Kommentar</label>
                                            <textarea id="comment" name="comment" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-full border border-gray-300 focus:ring-emerald-500 focus:border-emerald-500 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Kommentar"></textarea>
                                        </div>
                                    </div>
                                </div>
                        </div>
                    </div>
                    <!-- Lieferdaten -->
                    <h2 id="update-product-accordion-collapse-heading-2" style="margin: 0 -1.25rem; width: calc(100% + 2.5rem);">
                        <button type="button" id="deliverDataButton" class="modal-accordion-button flex items-center justify-between w-full px-4 py-4 font-medium leading-none text-left text-gray-900 border-t border-gray-200 sm:px-5 bg-gray-50 hover:bg-gray-100 dark:hover:bg-gray-600" data-accordion-target="#update-product-accordion-collapse-body-2" aria-expanded="true" aria-controls="update-product-accordion-collapse-body-3">
                            <span>Lieferdaten</span>
                            <svg aria-hidden="true" data-accordion-icon="" class="w-6 h-6 rotate-180 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                        </button>
                    </h2>
                    <div id="update-product-accordion-collapse-body-2" class="hidden" aria-labelledby="update-product-accordion-collapse-heading-2">
                        <div class="py-4 border-gray-200 sm:py-5 dark:border-gray-700">
                            <!-- Inputs -->
                                <!-- Column -->
                                <div class="">
                                    <div class="grid gap-4 mb-4 sm:grid-cols-3">
                                        <div>
                                            <label for="del_first_name" class="block mb-2 text-sm font-medium text-gray-900">Vorname</label>
                                            <input type="text" name="delFirstName" id="del_first_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Vorname" required="">
                                        </div>
                                        <div>
                                            <label for="del_last_name" class="block mb-2 text-sm font-medium text-gray-900">Nachname</label>
                                            <input type="text" name="delLastName" id="del_last_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Nachname" required="">
                                        </div>
                                    </div>
                                    <div class="grid gap-4 mb-4 sm:grid-cols-3">
                                        <div>
                                            <label for="del_street" class="block mb-2 text-sm font-medium text-gray-900">Straße</label>
                                            <input type="text" name="delStreet" id="del_street" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Straße" required="">
                                        </div>
                                        <div>
                                            <label for="del_street_number" class="block mb-2 text-sm font-medium text-gray-900">Hausnummer</label>
                                            <input type="text" name="delStreetNumber" id="del_street_number" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Hausnummer" required="">
                                        </div>
                                        <div>
                                            <label for="del_postalcode" class="block mb-2 text-sm font-medium text-gray-900">Postleitzahl</label>
                                            <input type="text" name="delPostalcode" id="del_postalcode" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Postleitzahl" required="">
                                        </div>
                                    </div>
                                    <div class="grid gap-4 mb-4 sm:grid-cols-2">
                                        <div>
                                            <label for="del_city" class="block mb-2 text-sm font-medium text-gray-900">Stadt</label>
                                            <input type="text" name="delCity" id="del_city" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Stadt" required="">
                                        </div>
                                        <div>
                                            <label for="del_country" class="block mb-2 text-sm font-medium text-gray-900">Land</label>
                                            <select id="del_country" name="delCountry" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                                {% get_choices "CountryChoices" as countries %}
                                                {% for item in countries %}
                                                <option value="{{item.0}}" {% if order.country == item.0 %}selected{% endif %}>{{ item.1 }}</option>
                                                {% endfor %}
                                            </select>
                                        </div>
                                        <div class="sm:col-span-2">
                                            <label for="del_comment" class="block mb-2 text-sm font-medium text-gray-900">Kommentar</label>
                                            <textarea id="del_comment" name="delComment" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-full border border-gray-300 focus:ring-emerald-500 focus:border-emerald-500 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Kommentar"></textarea>
                                        </div>
                                    </div>
                                </div>
                        </div>
                    </div>
                    <!-- Rezepte -->
                    <h2 id="update-product-accordion-collapse-heading-3" style="margin: 0 -1.25rem; width: calc(100% + 2.5rem);">
                        <button type="button" id="recipeButton" class="modal-accordion-button flex items-center justify-between w-full px-4 py-4 font-medium leading-none text-left text-gray-900 border-t border-gray-200 sm:px-5 bg-gray-50 hover:bg-gray-100 dark:hover:bg-gray-600" data-accordion-target="#update-product-accordion-collapse-body-3" aria-expanded="false" aria-controls="update-product-accordion-collapse-body-4">
                            <span>Rezepte</span>
                            <svg aria-hidden="true" data-accordion-icon="" class="w-6 h-6 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                        </button>
                    </h2>
                    <div id="update-product-accordion-collapse-body-3" class="hidden" aria-labelledby="update-product-accordion-collapse-heading-3">
                        <div class="border-gray-200 dark:border-gray-700">
                            <!-- Hochladen -->
                            <div class="mt-4 grid gap-4 mb-5 sm:grid-cols-2">
                                <div>
                                    <label class="block mb-2 text-sm font-medium text-gray-900" for="recipeFile">Rezept hochladen</label>
                                    <input class="block w-full text-sm text-gray-900 border border-gray-300 rounded-full cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:placeholder-gray-400" aria-describedby="file_input_help" id="recipeFile" name="recipeFile" type="file">
                                    <p class="mt-1 text-sm text-gray-500 dark:text-gray-300">PDF, PNG oder JPG.</p>
                                </div>
                                <div class="pt-7 flex flex-row">
                                    <input type="text" name="recipeNumber" class="hidden mr-4 flex-grow mb-auto bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Rezeptnummer*">
                                    <div class="flex items-center ms-auto me-4 mb-auto py-2.5">
                                        <input checked id="eRecipe" name="eRecipe" onchange="changeRecipeType(this)" type="checkbox" class="cursor-pointer w-4 h-4 text-emerald-600 bg-gray-100 border-gray-300 rounded focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-800 focus:ring-2 dark:border-gray-600">
                                        <label for="eRecipe" class="cursor-pointer ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">E-Rezept</label>
                                    </div>
                                    <button type="button" onclick="uploadRecipe()" class="mb-auto ml-auto text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-full text-sm px-5 py-2.5 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700">Hochladen</button>
                                </div>
                            </div>
                            <!-- Rezepte -->
                            <div id="recipeList" class="py-4 flex flex-col gap-4">
                                <!-- <div id="recipeFile-" class="flex flex-row mb-4 pl-2.5 bg-gray-50 border border-gray-300 rounded-full">
                                    <a href="#" class="mr-4 my-auto flex-grow text-md font-medium text-green-500 hover:text-green-700">
                                        Rezept.pdf
                                    </a>
                                    <button type="button" onclick="deleteRecipe()" class="ml-auto text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900">
                                        <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                            <path fill-rule="evenodd" d="M8.6 2.6A2 2 0 0 1 10 2h4a2 2 0 0 1 2 2v2h3a1 1 0 1 1 0 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a1 1 0 0 1 0-2h3V4c0-.5.2-1 .6-1.4ZM10 6h4V4h-4v2Zm1 4a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Zm4 0a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Z" clip-rule="evenodd"/>
                                        </svg>                                        
                                    </button>
                                </div> -->
                            </div>
                            <div id="orderRecipeAlert" class="hidden flex items-center p-4 mb-4 text-sm text-red-800 border border-red-300 rounded-full bg-red-50 dark:text-red-400 dark:border-red-800" role="alert">
                                <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                                </svg>
                                <div>
                                    <span class="font-medium">Fehler!</span> Bitte lade mindestens ein Rezept hoch.
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Produkte -->
                    <h2 id="update-product-accordion-collapse-heading-4" style="margin: 0 -1.25rem; width: calc(100% + 2.5rem);">
                        <button type="button" id="productsButton" class="modal-accordion-button flex items-center justify-between w-full px-4 py-4 font-medium leading-none text-left text-gray-900 border-t border-gray-200 sm:px-5 bg-gray-50 hover:bg-gray-100 dark:hover:bg-gray-600" data-accordion-target="#update-product-accordion-collapse-body-4" aria-expanded="false" aria-controls="update-product-accordion-collapse-body-4">
                            <span>Produkte</span>
                            <svg aria-hidden="true" data-accordion-icon="" class="w-6 h-6 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                        </button>
                    </h2>
                    <div id="update-product-accordion-collapse-body-4" class="hidden" aria-labelledby="update-product-accordion-collapse-heading-3">
                        <div class="border-gray-200 dark:border-gray-700">
                            <!-- Suche -->
                            <div class="grid gap-4 mb-4 sm:grid-cols-2">
                                <div class="relative mt-5 searchProductContainer">
                                    <!-- <div class="relative"> -->
                                    <div class="absolute inset-y-0 start-0 flex items-center ps-4 pointer-events-none">
                                        <svg class="h-3.5 w-3.5 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"/>
                                        </svg>
                                    </div>
                                    <input type="text" id="searchProduct" dropdown-max-height="300" data-search-type="add-product-search" class="searchProductInput bg-gray-50 border w-full border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block ps-10 p-2 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Produktsuche" required>
                                    <!-- </div> -->
                                    <!-- Dropdown menu -->
                                    <!-- <div class="dropdownProductList hidden z-20 w-full overflow-y-auto absolute bg-white divide-y divide-gray-100 rounded-full shadow-xl dark:divide-gray-700" aria-labelledby="dropdownNotificationButton">
                                        <div class="divide-y divide-gray-100 dark:divide-gray-700">
                                        </div>
                                    </div> -->

                                </div>
                            </div>
                            <!-- Produktliste -->
                            <div id="productList" class="pt-5 flex flex-col gap-4">
                                <!-- Bestelltes Produkt: ID xxx -->
                                <!-- <div class="product-item bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                    <div class="grid gap-4 sm:col-span-2 md:gap-6 sm:grid-cols-3 mb-3">
                                        <div>
                                            <label for="product" class="inline-flex items-center mb-2 text-sm font-medium text-gray-900">
                                                Produkt
                                            </label>
                                            <input type="text" name="product" id="product" value="" disabled class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">
                                        </div>
                                        <div>
                                            <label for="recipe" class="inline-flex items-center mb-2 text-sm font-medium text-gray-900">
                                                Rezept
                                            </label>
                                            <select id="recipe" name="recipe" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                                <option value="">Bitte wählen</option>
                                            </select>
                                        </div>
                                        <div class="ml-auto flex flex-row gap-4">
                                            <p class="pr-1.5 ml-auto text-lg font-medium text-gray-900">
                                                Preis: <span class="text-gray-900 dark:text-gray-300" name="productPrice"></span>
                                            </p>
                                            <button type="button" onclick="deleteProduct(this)" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm p-1.5 ml-auto mb-auto inline-flex dark:hover:bg-gray-600 dark:hover:text-white" data-modal-toggle="orderModal">
                                                <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                                                </svg>
                                                <span class="sr-only">Produkt löschen</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="grid gap-4 sm:col-span-2 md:gap-6 sm:grid-cols-4">
                                        <div>
                                            <label for="prepared" class="inline-flex items-center mb-2 text-sm font-medium text-gray-900">
                                                Abgabeform
                                            </label>
                                            <select id="prepared" name="prepared" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                                                <option value="">Bitte wählen</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label for="productAmount" class="block mb-2 text-sm font-medium text-gray-900" name="productAmountLabel">Menge</label>
                                            <input type="number" name="productAmount" id="productAmount" value="1" min="1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Beispiel: 12">
                                        </div>
                                        <div>
                                            <label for="form" class="block mb-2 text-sm font-medium text-gray-900">Form</label>
                                            <input type="text" name="form" id="form" value="" disabled class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">
                                        </div>
                                        <div>
                                            <label for="manufacturer" class="block mb-2 text-sm font-medium text-gray-900">Händler</label>
                                            <input type="text" name="manufacturer" id="manufacturer" value="" disabled class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                            <!-- Alert -->
                            <div id="orderProductsAlert" class="hidden flex items-center p-4 mb-4 text-sm text-red-800 border border-red-300 rounded-full bg-red-50 dark:text-red-400 dark:border-red-800" role="alert">
                                <svg class="flex-shrink-0 inline w-4 h-4 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                                  <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
                                </svg>
                                <div>
                                  <span class="font-medium">Fehler!</span> Bitte füge mindestens ein Produkt hinzu.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="d-flex justify-between pt-4 sm:flex sm:space-y-0 sm:space-x-4">
                    <div class="mb-4 sm:mb-0 items-center d-flex space-y-4 sm:flex sm:space-y-0 sm:space-x-4">
                        <button id="updateOrderBtn" type="button" onclick="saveOrder()" data-toast-name="orderUpdatedToast" type="submit" class="w-full sm:w-auto justify-center text-white inline-flex bg-emerald-700 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:bg-emerald-600 dark:hover:bg-emerald-700 dark:focus:ring-emerald-800">
                            Speichern
                        </button>
                        <button onclick="hideModal('orderModal')" type="button" class="w-full justify-center sm:w-auto text-gray-500 inline-flex items-center bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-emerald-300 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                            <svg class="mr-1 -ml-1 w-5 h-5" fill="currentColor" viewbox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                            Abbrechen
                        </button>
                        <button data-tooltip-target="deleteOrderTooltip" onclick="deleteOrder()" type="button" class="flex m-auto font-medium rounded-full text-sm px-5 py-2.5 border border-red-700 hover:text-white hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900">
                            Bestellung löschen
                            <svg class="ml-2 w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 17.94 6M18 18 6.06 6"/>
                            </svg>
                        </button>
                        <div id="deleteOrderTooltip" role="tooltip" name="deleteOrderTooltip" class="absolute z-10 invisible inline-block px-3 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-sm opacity-0 tooltip dark:bg-gray-700">
                            Hiermit löschen Sie die Bestellung. Dieser Vorgang kann nicht rückgängig gemacht werden.
                            <div class="tooltip-arrow" data-popper-arrow></div>
                        </div>
                    </div>
                </div>
            </form>

        </div>
    </div>
</div>

<!-- Pop Up Modal for stornieren an order -->
<div id="storno-popup-modal" data-modal-target="storno-popup-modal" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative w-full max-w-md max-h-full">
        <div class="relative bg-white rounded-full shadow dark:bg-gray-700">
            <button type="button" class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="storno-popup-modal">
                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                </svg>
                <span class="sr-only">Close modal</span>
            </button>
            <div class="pt-6 px-6 text-center">
                <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                </svg>
                <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Möchten Sie die Bestellung wirklich stornieren? Dieser Vorgang kann nicht rückgängig gemacht werden.</h3>
            </div>
            <form id="cancellationForm">
                <!-- Oder Id -->
                <input type="text" name="orderId" hidden>
                <div class="px-6 mb-6 text-start w-100">
                    <div>
                        <label for="cancellationReason" class="block mb-2 font-medium text-base text-gray-900">Stornierungsgrund</label>
                        <select id="cancellationReason" name="cancellationReason" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">
                            <option selected value="" disabled>Bitte den Grund wählen</option>
                            {% for item in cancellation_reasons %}
                            <option value="{{ item.id }}">{{ item.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="p-4 mb-4 mt-4 text-sm text-red-800 rounded-full bg-red-50 dark:text-red-400 hidden" name="cancellationAlert" role="alert">
                        Bitte den Stornierungsgrund wählen.
                    </div>
                </div>

                <div class="pb-6 px-6 flex justify-between">
                    <button onclick="stornoOrder()" type="button" class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-full text-sm inline-flex items-center px-5 py-2.5 text-center mr-2">
                        Ja, ich bin mir sicher
                    </button>
                    <button onclick="hideModal('storno-popup-modal')" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                        Abbrechen
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>


<!-- Pop Up Modal for create new invoice -->
<div id="create-new-invoice-modal" data-modal-target="create-new-invoice-modal" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative w-full max-w-md max-h-full">
        <div class="relative bg-white rounded-full shadow dark:bg-gray-700">
            <button type="button" class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="storno-popup-modal">
                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                </svg>
                <span class="sr-only">Close modal</span>
            </button>
            <div class="pt-6 px-6 text-center">
                <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                </svg>
                <h3 class="mb-2 text-lg font-normal text-gray-500 dark:text-gray-400">Möchten Sie eine neue Rechnung erstellen?.</h3>
                <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Hiermit wird die alte Rechnung <strong>storniert</strong>.</h3>
            </div>
            <form id="cancellationForm">
                <!-- Oder Id -->
                <input type="text" name="orderId" hidden>

                <div class="pb-6 px-6 flex justify-between">
                    <button onclick="saveCreateNewInvoice()" type="button" class="text-white bg-emerald-700 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:bg-emerald-600 dark:hover:bg-emerald-700 dark:focus:ring-emerald-800 mr-2">
                        Rechnung erstellen
                    </button>
                    <button onclick="hideModal('create-new-invoice-modal')" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                        Abbrechen
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Pop Up Modal for comment order status = queries -->
<div id="queries-popup-modal" data-modal-target="queries-popup-modal" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative w-full max-w-md max-h-full">
        <div class="relative bg-white rounded-full shadow dark:bg-gray-700">
            <button type="button" class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="queries-popup-modal">
                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                </svg>
                <span class="sr-only">Close modal</span>
            </button>
            <div class="pt-6 px-6 text-center">
                <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                    <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm9.008-3.018a1.502 1.502 0 0 1 2.522 1.159v.024a1.44 1.44 0 0 1-1.493 1.418 1 1 0 0 0-1.037.999V14a1 1 0 1 0 2 0v-.539a3.44 3.44 0 0 0 2.529-3.256 3.502 3.502 0 0 0-7-.255 1 1 0 0 0 2 .076c.014-.398.187-.774.48-1.044Zm.982 7.026a1 1 0 1 0 0 2H12a1 1 0 1 0 0-2h-.01Z" clip-rule="evenodd"/>
                </svg>                  
                <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Welche Rückfragen gibt es zur Bestellung?</h3>
            </div>
            <form id="cancellationForm">
                <!-- Oder Id -->
                <input type="text" name="orderId" hidden>
                <div class="px-6 mb-6 text-start w-100">
                    <div>                      
                        <label for="queriesComment" class="block mb-2 text-sm font-medium text-gray-900">Rückfragen</label>
                        <textarea id="queriesComment" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-full border border-gray-300 focus:ring-emerald-500 focus:border-emerald-500 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Rückfragen zur Bestellung hier reinschreiben..."></textarea>
                    </div>
                    <div class="p-4 mb-4 mt-4 text-sm text-red-800 rounded-full bg-red-50 dark:text-red-400 hidden" name="queriesAlert" role="alert">
                        Bitte einen Kommentar für die Rückfragen angeben.
                    </div>
                </div>

                <div class="pb-6 px-6 flex justify-between">
                    <button onclick="saveQuariesStatus()" type="button" class="text-white bg-emerald-600 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 dark:focus:ring-emerald-800 font-medium rounded-full text-sm inline-flex items-center px-5 py-2.5 text-center mr-2">
                        Status speichern
                    </button>
                    <button onclick="hideModal('queries-popup-modal')" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                        Abbrechen
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Pop Up Modal for comment order status = clarified -->
<div id="clarified-popup-modal" data-modal-target="clarified-popup-modal" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative w-full max-w-md max-h-full">
        <div class="relative bg-white rounded-full shadow dark:bg-gray-700">
            <button type="button" class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="queries-popup-modal">
                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                </svg>
                <span class="sr-only">Close modal</span>
            </button>
            <div class="pt-6 px-6 text-center">
                <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                    <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm9.008-3.018a1.502 1.502 0 0 1 2.522 1.159v.024a1.44 1.44 0 0 1-1.493 1.418 1 1 0 0 0-1.037.999V14a1 1 0 1 0 2 0v-.539a3.44 3.44 0 0 0 2.529-3.256 3.502 3.502 0 0 0-7-.255 1 1 0 0 0 2 .076c.014-.398.187-.774.48-1.044Zm.982 7.026a1 1 0 1 0 0 2H12a1 1 0 1 0 0-2h-.01Z" clip-rule="evenodd"/>
                </svg>                  
                <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Sind die Rückfragen geklärt?</h3>
            </div>
            <form id="cancellationForm">
                <!-- Oder Id -->
                <input type="text" name="orderId" hidden>
                <div class="px-6 mb-6 text-start w-100">
                    <div>                      
                        <label for="clarifiedComment" class="block mb-2 text-sm font-medium text-gray-900">Klärung</label>
                        <textarea id="clarifiedComment" rows="4" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-full border border-gray-300 focus:ring-emerald-500 focus:border-emerald-500 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Klärung der Rückfragen hier reinschreiben..."></textarea>
                    </div>
                    <div class="p-4 mb-4 mt-4 text-sm text-red-800 rounded-full bg-red-50 dark:text-red-400 hidden" name="clarifiedAlert" role="alert">
                        Bitte einen Kommentar für die Klärung angeben.
                    </div>
                </div>

                <div class="pb-6 px-6 flex justify-between">
                    <button onclick="saveClarifiedStatus()" type="button" class="text-white bg-emerald-600 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 dark:focus:ring-emerald-800 font-medium rounded-full text-sm inline-flex items-center px-5 py-2.5 text-center mr-2">
                        Status speichern
                    </button>
                    <button onclick="hideModal('clarified-popup-modal')" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                        Abbrechen
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Pop Up Modal for upload new recipe -->
<div id="upload-recipe-popup-modal" data-modal-target="upload-recipe-popup-modal" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative w-full max-w-md max-h-full">
        <div class="relative bg-white rounded-full shadow dark:bg-gray-700">
            <button type="button" class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="queries-popup-modal">
                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                </svg>
                <span class="sr-only">Close modal</span>
            </button>
            <div class="pt-6 px-6 text-center">
                <svg class="mx-auto mb-4 text-gray-800" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                    <path fill-rule="evenodd" d="M12 3a1 1 0 0 1 .78.375l4 5a1 1 0 1 1-1.56 1.25L13 6.85V14a1 1 0 1 1-2 0V6.85L8.78 9.626a1 1 0 1 1-1.56-1.25l4-5A1 1 0 0 1 12 3ZM9 14v-1H5a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-4v1a3 3 0 1 1-6 0Zm8 2a1 1 0 1 0 0 2h.01a1 1 0 1 0 0-2H17Z" clip-rule="evenodd"/>
                </svg>
                <h3 class="mb-3 text-lg font-normal text-gray-500 dark:text-gray-400">Neues Rezept hochladen</h3>
                <h4 class="mb-5 text-md font-normal text-gray-500 dark:text-gray-400">Bestellnummer: <span name="order_number"></span></h4>
            </div>
            <form id="uploadRecipeForm">
                <!-- Oder Id -->
                <input type="text" name="orderId" hidden>
                <div class="px-6 mb-6 text-start w-100">
                    <div>
                        <label class="block mb-2 text-sm font-medium text-gray-900" for="newRecipeFile">Rezept</label>
                        <input id="newRecipeFile" name="newRecipeFile" class="block w-full text-sm text-gray-900 border border-gray-300 rounded-full cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:placeholder-gray-400" type="file">
                    </div>
                    <div class="mt-3 flex flex-col">
                        <input type="text" name="recipeNumber" class="hidden w-full mb-auto bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="Rezeptnummer*">
                        <div class="flex items-center mt-3">
                            <input checked id="eRecipe" name="eRecipe" onchange="changeRecipeType(this)" type="checkbox" class="cursor-pointer w-4 h-4 text-emerald-600 bg-gray-100 border-gray-300 rounded focus:ring-emerald-500 dark:focus:ring-emerald-600 dark:ring-offset-gray-800 focus:ring-2 dark:border-gray-600">
                            <label for="eRecipe" class="cursor-pointer ms-2 text-sm font-medium text-gray-900 dark:text-gray-300">E-Rezept</label>
                        </div>
                    </div>
                    <div class="p-4 mb-4 mt-4 text-sm text-red-800 rounded-full bg-red-50 dark:text-red-400 hidden" name="recipeFileAlert" role="alert">
                        Bitte ein Rezept hochladen.
                    </div>
                    <div class="p-4 mb-4 mt-4 text-sm text-red-800 rounded-full bg-red-50 dark:text-red-400 hidden" name="recipeNumberAlert" role="alert">
                        Bitte die Rezeptnummer angeben.
                    </div>
                </div>

                <div class="pb-6 px-6 flex justify-between">
                    <button onclick="saveUploadNewRecipe()" type="button" class="text-white bg-emerald-600 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 dark:focus:ring-emerald-800 font-medium rounded-full text-sm inline-flex items-center px-5 py-2.5 text-center mr-2">
                        Rezept hochladen
                    </button>
                    <button onclick="hideModal('upload-recipe-popup-modal')" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                        Abbrechen
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Pop Up Modal for create new invoice -->
<div id="create-new-invoice-modal" data-modal-target="create-new-invoice-modal" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative w-full max-w-md max-h-full">
        <div class="relative bg-white rounded-full shadow dark:bg-gray-700">
            <button type="button" class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm w-8 h-8 ml-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="storno-popup-modal">
                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                </svg>
                <span class="sr-only">Close modal</span>
            </button>
            <div class="pt-6 px-6 text-center">
                <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                </svg>
                <h3 class="mb-2 text-lg font-normal text-gray-500 dark:text-gray-400">Möchten Sie eine neue Rechnung erstellen?</h3>
                <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Hiermit wird die alte Rechnung <strong>storniert</strong>.</h3>
            </div>
            <form id="cancellationForm">
                <!-- Order Id -->
                <input type="text" name="orderId" hidden>

                <div class="pb-6 px-6 flex justify-between">
                    <button onclick="saveCreateNewInvoice()" type="button" class="text-white bg-emerald-700 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:bg-emerald-600 dark:hover:bg-emerald-700 dark:focus:ring-emerald-800 mr-2">
                        Rechnung erstellen
                    </button>
                    <button onclick="hideModal('create-new-invoice-modal')" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                        Abbrechen
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Pop Up Modal for payment_status = paid -->
<div id="payment-status-received-modal" data-modal-target="create-new-invoice-modal" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative w-full max-w-md max-h-full">
        <div class="relative bg-white rounded-full shadow dark:bg-gray-700">
            <div class="pt-6 px-6 text-center">
                <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 10h9.231M6 14h9.231M18 5.086A5.95 5.95 0 0 0 14.615 4c-3.738 0-6.769 3.582-6.769 8s3.031 8 6.769 8A5.94 5.94 0 0 0 18 18.916"/>
                </svg>                  
                <h3 class="mb-2 text-lg font-normal text-gray-500 dark:text-gray-400">Wurde die Bestellung vollständig bezahlt?.</h3>
                <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Hiermit wird die Bestellung auf <strong>Bezahlt</strong> gesetzt und der Kunde erhält eine Bestätigung per E-Mail.</h3>
            </div>
            <form id="confirmPaymentPaid">
                <!-- Order Id -->
                <input type="text" name="orderId" hidden>

                <div class="pb-6 px-6 flex justify-between">
                    <button onclick="savePaymentStatus()" type="button" class="text-white bg-emerald-700 hover:bg-emerald-700 focus:ring-4 focus:outline-none focus:ring-emerald-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:bg-emerald-600 dark:hover:bg-emerald-700 dark:focus:ring-emerald-800 mr-2">
                        Bestellung bezahlt
                    </button>
                    <button onclick="hideModal('payment-status-received-modal')" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                        Abbrechen
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Pop Up Modal for deleting a product from order -->
<div id="product-delete-modal" data-modal-target="product-delete-modal" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative w-full max-w-md max-h-full">
        <div class="relative bg-white rounded-full shadow dark:bg-gray-700">
            <div class="p-6 text-center">
                <input type="text" name="productId" hidden>
                <input type="text" name="orderId" hidden>
                <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                </svg>
                <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">
                    Möchten Sie das Produkt <span class="font-bold" name="productName"></span> aus der Bestellung <span class="font-bold" name="orderNumber"></span> löschen?
                </h3>
                <button onclick="saveDeleteOrderProduct()" type="button" class="text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-full text-sm inline-flex items-center px-5 py-2.5 text-center mr-2">
                    Ja, ich bin mir sicher
                </button>
                <button onclick="cancelDeleteOrderProduct()" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-full border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                    Abbrechen
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Success Modal -->
<div id="order-success-modal" aria-hidden="true" tabindex="-1" class="fixed top-0 left-0 right-0 z-50 hidden p-4 overflow-x-hidden overflow-y-auto md:inset-0 h-[calc(100%-1rem)] max-h-full bg-gray-900 bg-opacity-60">
    <div class="relative w-full max-w-md max-h-full">
        <div class="relative bg-white rounded-full shadow dark:bg-gray-700">
            <div class="p-6 text-center">
                <svg class="mx-auto mb-4 w-12 h-12 text-green-500 dark:text-green-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 4h3c.6 0 1 .4 1 1v15c0 .6-.4 1-1 1H6a1 1 0 0 1-1-1V5c0-.6.4-1 1-1h3m0 3h6m-6 7 2 2 4-4m-5-9v4h4V3h-4Z"/>
                </svg>
                <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">
                    Die Bestellung wurde erfolgreich angelegt und der Kunde hat eine E-Mail zur Bestätigung der Bestellung erhalten.
                </h3>
                <a href="{% url 'dashboard_review_orders' %}" type="button" class="focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-full text-sm px-5 py-2.5 me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800">
                    Verstanden
                </a>
            </div>
        </div>
    </div>
</div>

{% endblock content %}

{% block scripts %}

<script src="{% static '/js/cartProduct.js' %}?version=1.0.1"></script>
<!-- Search product -->
<script src="{% static '/js/productSearch.js' %}?version=1.1" data-product-url="{% url 'request_product_datas' %}" data-pharmacy-id="{{ selected_pharmacy_id }}"></script>

<!-- Popup for Customer Name/Number/Address Popup -->
<script data-orderids="{{ orders_dic }}">

    const orderData = document.currentScript.dataset
    
    let orderIds = JSON.parse(orderData.orderids)

    $(document).ready(function() {

        orderIds.forEach(oderId => {

            let popover = new bootstrap.Popover(document.getElementById('customer'+ oderId),
                {
                    html: true,
                    content: $('[data-name="popover-content-' + oderId + '"]')
                }
            )
        });

    })
</script>

<!-- Validate order -->
<script>
    const orderId = $('input[name=orderId]', '#orderDetailsForm');
    const orderAmount = $('[name=orderAmount]', '#orderDetailsForm');
    const deliveryType = $('select[name=deliveryType]', '#orderDetailsForm');
    const paymentType = $('select[name=paymentType]', '#orderDetailsForm');
    const customerType = $('select[name=customerType]', '#orderDetailsForm');
    const recipeStatus = $('select[name=recipeStatus]', '#orderDetailsForm');

    // Bestelldetails
    const salutation = $('select[name=salutation]', '#orderDetailsForm');
    const firstName = $('input[name=firstName]', '#orderDetailsForm');
    const lastName = $('input[name=lastName]', '#orderDetailsForm');
    const birthDate = $('input[name=birthDate]', '#orderDetailsForm');
    const street = $('input[name=street]', '#orderDetailsForm');
    const streetNumber = $('input[name=streetNumber]', '#orderDetailsForm');
    const postalcode = $('input[name=postalcode]', '#orderDetailsForm');
    const city = $('input[name=city]', '#orderDetailsForm');
    const country = $('select[name=country]', '#orderDetailsForm');
    const phonenumber = $('input[name=phonenumber]', '#orderDetailsForm');
    const email = $('input[name=email]', '#orderDetailsForm');
    const comment = $('textarea[name=comment]', '#orderDetailsForm');

    // Lieferdaten
    const delFirstName = $('input[name=delFirstName]', '#orderDetailsForm');
    const delLastName = $('input[name=delLastName]', '#orderDetailsForm');
    const delStreet = $('input[name=delStreet]', '#orderDetailsForm');
    const delStreetNumber = $('input[name=delStreetNumber]', '#orderDetailsForm');
    const delPostalcode = $('input[name=delPostalcode]', '#orderDetailsForm');
    const delCity = $('input[name=delCity]', '#orderDetailsForm');
    const delCountry = $('select[name=delCountry]', '#orderDetailsForm');
    const delComment = $('textarea[name=delComment]', '#orderDetailsForm');

    // Rezept
    const recipeFile = $('input[name=recipeFile]', '#orderDetailsForm')
    const recipeNumber = $('input[name=recipeNumber]', '#orderDetailsForm')
    const eRecipe = $('input[name=eRecipe]', '#orderDetailsForm')

    const regexEmail = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/

    const getOrderDetails = (id) => {

        $('#productList').empty();
        $('#recipeList').empty();

        $('#orderDetailsForm input').removeClass('input-error')
        $('#orderDetailsForm select').removeClass('input-error')
        $('#invoiceData').removeClass('button-error')

        var timer = setTimeout(function() {
            // Zeigen Sie den Ladebildschirm an, wenn die Ajax-Anfrage noch nicht fertig ist
            $('.loading-screen').addClass('hidden')
        }, 2000);
        
        $.ajax({
            type: 'POST',
            url: '{% url "request_order_functions" %}',
            traditional: true,
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': getCookie('csrftoken')
            },
            data: {
                'getOrderDetails': 'getOrderDetails',
                'orderId': id,
            },
            success: (data) => {
        
                clearTimeout(timer);
                $('.loading-screen').addClass('hidden')

                orderId.val(id)

                let order = data.order

                // Invoice Data
                salutation.val(order.salutation)
                firstName.val(order.firstName)
                lastName.val(order.lastName)
                birthDate.val(order.birthDate)
                email.val(order.email)
                phonenumber.val(order.phonenumber)
                street.val(order.street)
                streetNumber.val(order.streetNumber)
                city.val(order.city)
                postalcode.val(order.postalcode)
                country.val(order.country)
                customerType.val(order.customerType)
                deliveryType.val(order.deliveryType)
                paymentType.val(order.paymentType)
                
                // Delivery Data
                delFirstName.val(order.delFirstName)
                delLastName.val(order.delLastName)
                delStreet.val(order.delStreet)
                delStreetNumber.val(order.delStreetNumber)
                delCity.val(order.delCity)
                delPostalcode.val(order.delPostalcode)
                delCountry.val(order.delCountry)

                // Product Data
                for (order_product of order.orderProducts) {

                    let template = '<div id="productItem-' + order_product.id + '" class="product-item bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">\
                                    <div class="grid gap-4 sm:col-span-2 md:gap-6 sm:grid-cols-2 mb-3">\
                                        <div>\
                                            <label for="product" class="inline-flex items-center mb-2 text-sm font-medium text-gray-900">\
                                                Produkt\
                                            </label>\
                                            <input type="text" name="product" id="product" value="' + order_product.name + '" disabled class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">\
                                        </div>\
                                        <div class="ml-auto flex flex-row gap-4">\
                                            <p class="pr-1.5 ml-auto text-lg font-medium text-gray-900">\
                                                Preis: <span class="text-gray-900 dark:text-gray-300" name="productPrice">' + order_product.total + '</span>\
                                            </p>\
                                            <button type="button" onclick="deleteProduct(' + order_product.id + ')" data-modal-target="product-delete-popup-modal" data-modal-toggle="product-delete-popup-modal" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm p-1.5 ml-auto mb-auto inline-flex dark:hover:bg-gray-600 dark:hover:text-white" data-modal-toggle="orderModal">\
                                                <svg class="w-5 h-5 text-red-700 dark:text-red-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">\
                                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"/>\
                                                </svg>\
                                                <span class="sr-only">Produkt löschen</span>\
                                            </button>\
                                        </div>\
                                    </div>\
                                    <div class="grid gap-4 sm:col-span-2 md:gap-6 sm:grid-cols-4">\
                                        <div>\
                                            <label for="prepared" class="inline-flex items-center mb-2 text-sm font-medium text-gray-900">\
                                                Abgabeform\
                                            </label>\
                                            <select id="prepared" name="prepared" onchange="changeProductDetails(' + order_product.id + ')" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">\
                                                <option value="0">Unverarbeitet</option>\
                                                <option value="1">Zerkleinert</option>\
                                            </select>\
                                        </div>\
                                        <div>\
                                            <label for="productAmount" class="block mb-2 text-sm font-medium text-gray-900" name="productAmountLabel">Menge</label>\
                                            <input type="number" name="productAmount" onchange="changeProductDetails(' + order_product.id + ')" id="productAmount" value="' + order_product.amount + '" min="1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">\
                                        </div>\
                                        <div>\
                                            <label for="form" class="block mb-2 text-sm font-medium text-gray-900">Form</label>\
                                            <input type="text" name="form" id="form" value="' + order_product.form + '" disabled class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">\
                                        </div>\
                                        <div>\
                                            <label for="manufacturer" class="block mb-2 text-sm font-medium text-gray-900">Händler</label>\
                                            <input type="text" name="manufacturer" id="manufacturer" value="' + order_product.supplier + '" disabled class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">\
                                        </div>\
                                    </div>\
                                </div>'

                    $('#productList').append(template);
                }

                // Recipe Data
                for (order_recipe of order.orderRecipes) {
                    console.table(order_recipe)
                    let template = '<div id="recipeFile-' + order_recipe.id + '" class="flex flex-row pl-2.5 bg-gray-50 border border-gray-300 rounded-full">\
                                        <a href="' + order_recipe.url + '" class="mr-4 my-auto flex-grow text-md font-medium text-green-500 hover:text-green-700">\
                                            ' + order_recipe.name + ' (' + order_recipe.number + ')\
                                        </a>\
                                        <button type="button" onclick="deleteRecipe(' + order_recipe.id + ')" class="ml-auto text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900">\
                                            <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">\
                                                <path fill-rule="evenodd" d="M8.6 2.6A2 2 0 0 1 10 2h4a2 2 0 0 1 2 2v2h3a1 1 0 1 1 0 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a1 1 0 0 1 0-2h3V4c0-.5.2-1 .6-1.4ZM10 6h4V4h-4v2Zm1 4a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Zm4 0a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Z" clip-rule="evenodd"/>\
                                            </svg>\
                                        </button>\
                                    </div>'

                    $('#recipeList').append(template)
                }

                $('#orderAmount').html(order.orderAmount)

                toggleModal('orderModal', {'backdrop': 'static'})

            },
            error: () => {
        
                clearTimeout(timer);
                $('.loading-screen').addClass('hidden')
                toggleModal('alert-modal')
        
            }
        })

    }

    const addProduct = (productId) => {

        var timer = setTimeout(function() {
            // Zeigen Sie den Ladebildschirm an, wenn die Ajax-Anfrage noch nicht fertig ist
            $('.loading-screen').addClass('hidden')
        }, 2000);
        
        $.ajax({
            type: 'POST',
            url: '{% url "request_customer_functions" %}',
            traditional: true,
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': getCookie('csrftoken')
            },
            data: {
                'addProduct': 'addProduct',
                'orderId': orderId.val(),
                'productId': productId,
            },
            success: (data) => {

                $('#orderProductsAlert').addClass('hidden')
        
                clearTimeout(timer);
                $('.loading-screen').addClass('hidden')

                let template = '<div id="productItem-' + data.product.id + '" class="product-item bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">\
                                    <div class="grid gap-4 sm:col-span-2 md:gap-6 sm:grid-cols-2 mb-3">\
                                        <div>\
                                            <label for="product" class="inline-flex items-center mb-2 text-sm font-medium text-gray-900">\
                                                Produkt\
                                            </label>\
                                            <input type="text" name="product" id="product" value="' + data.product.name + '" disabled class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">\
                                        </div>\
                                        <div class="ml-auto flex flex-row gap-4">\
                                            <p class="pr-1.5 ml-auto text-lg font-medium text-gray-900">\
                                                Preis: <span class="text-gray-900 dark:text-gray-300" name="productPrice">' + data.product.total + '</span>\
                                            </p>\
                                            <button type="button" onclick="deleteProduct(' + data.product.id + ')" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-full text-sm p-1.5 ml-auto mb-auto inline-flex dark:hover:bg-gray-600 dark:hover:text-white" data-modal-toggle="orderModal">\
                                                <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">\
                                                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>\
                                                </svg>\
                                                <span class="sr-only">Produkt löschen</span>\
                                            </button>\
                                        </div>\
                                    </div>\
                                    <div class="grid gap-4 sm:col-span-2 md:gap-6 sm:grid-cols-4">\
                                        <div>\
                                            <label for="prepared" class="inline-flex items-center mb-2 text-sm font-medium text-gray-900">\
                                                Abgabeform\
                                            </label>\
                                            <select id="prepared" name="prepared" onchange="changeProductDetails(' + data.product.id + ')" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-500 focus:border-emerald-500 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500">\
                                                <option value="0">Unverarbeitet</option>\
                                                <option value="1">Zerkleinert</option>\
                                            </select>\
                                        </div>\
                                        <div>\
                                            <label for="productAmount" class="block mb-2 text-sm font-medium text-gray-900" name="productAmountLabel">Menge</label>\
                                            <input type="number" name="productAmount" onchange="changeProductDetails(' + data.product.id + ')" id="productAmount" value="1" min="1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">\
                                        </div>\
                                        <div>\
                                            <label for="form" class="block mb-2 text-sm font-medium text-gray-900">Form</label>\
                                            <input type="text" name="form" id="form" value="' + data.product.form + '" disabled class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">\
                                        </div>\
                                        <div>\
                                            <label for="manufacturer" class="block mb-2 text-sm font-medium text-gray-900">Händler</label>\
                                            <input type="text" name="manufacturer" id="manufacturer" value="' + data.product.supplier + '" disabled class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-full focus:ring-emerald-600 focus:border-emerald-600 block w-full p-2.5 dark:placeholder-gray-400 dark:focus:ring-emerald-500 dark:focus:border-emerald-500" placeholder="">\
                                        </div>\
                                    </div>\
                                </div>'

                $('#productList').append(template);

                $('#orderAmount').html(data.total)
        
            },
            error: () => {
        
                clearTimeout(timer);
                $('.loading-screen').addClass('hidden')
                toggleModal('alert-modal')
        
            }
        })

    }

    const changeProductDetails = (orderProductId) => {

        var timer = setTimeout(function() {
            // Zeigen Sie den Ladebildschirm an, wenn die Ajax-Anfrage noch nicht fertig ist
            $('.loading-screen').addClass('hidden')
        }, 2000);
        
        $.ajax({
            type: 'POST',
            url: '{% url "request_customer_functions" %}',
            traditional: true,
            data: {
                'changeProductDetails': 'changeProductDetails',
                'orderProductId': orderProductId,
                'amount': $('#productItem-' + orderProductId + ' input[name=productAmount]').val(),
                'prepared': $('#productItem-' + orderProductId + ' select[name=prepared]').val(),
            },
            success: (data) => {
        
                clearTimeout(timer);
                $('.loading-screen').addClass('hidden')

                $('#productItem-' + orderProductId + ' [name=productPrice]').html(data.product_total)
                $('#orderAmount').html(data.total)
        
            },
            error: () => {
        
                clearTimeout(timer);
                $('.loading-screen').addClass('hidden')
                toggleModal('alert-modal')
        
            }
        })

    }

    const deleteProduct  = (productId) => {

        $.ajax({
            type: 'POST',
            url: '{% url "request_customer_functions" %}',
            traditional: true,
            data: {
                'deleteOrderProduct': 'deleteOrderProduct',
                'productId': productId,
            },
            success: (data) => {

                $('#productItem-' + productId).remove()

                // Update order amount
                $('#orderAmount').html(data.total)
        
            },
            error: () => {
        
                toggleModal('alert-modal')
        
            }
        })

    }

    // Upload recipe files
    const uploadRecipe = () => {

        var recipeData = new FormData();

        if (recipeFile[0].files.length == 0) {
            recipeFile.addClass('input-error')
            return false;
        }

        if (!eRecipe.prop('checked') && recipeNumber.val() == '') {
            recipeNumber.addClass('input-error')
            return false;
        }

        recipeData.append('recipeFile', recipeFile[0].files[0])
        recipeData.append('recipeNumber', recipeNumber.val())
        recipeData.append('eRecipe', JSON.stringify(eRecipe.prop('checked')))
        recipeData.append('orderId', orderId.val())
        recipeData.append('uploadRecipeFile', 'uploadRecipeFile')

        var timer = setTimeout(function() {
            // Zeigen Sie den Ladebildschirm an, wenn die Ajax-Anfrage noch nicht fertig ist
            $('.loading-screen').addClass('hidden')
        }, 2000);
        
        $.ajax({
            type: 'POST',
            url: '{% url "request_customer_functions" %}',
            processData: false,  // Wichtig: Verhindert, dass jQuery die Daten verarbeitet
            contentType: false,
            traditional: true,
            data: recipeData,
            success: (data) => {

                $('#orderRecipeAlert').addClass('hidden')
        
                clearTimeout(timer);
                $('.loading-screen').addClass('hidden')

                let template = '<div id="recipeFile-' + data.recipeId + '" class="flex flex-row pl-2.5 bg-gray-50 border border-gray-300 rounded-full">\
                                    <a href="' + data.recipeUrl + '" class="mr-4 my-auto flex-grow text-md font-medium text-green-500 hover:text-green-700">\
                                        ' + data.recipeName + ' (' + data.recipeNumber + ')\
                                    </a>\
                                    <button type="button" onclick="deleteRecipe(' + data.recipeId + ')" class="ml-auto text-red-700 hover:text-white border border-red-700 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-full text-sm px-5 py-2.5 text-center dark:border-red-500 dark:text-red-500 dark:hover:text-white dark:hover:bg-red-600 dark:focus:ring-red-900">\
                                        <svg class="w-4 h-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">\
                                            <path fill-rule="evenodd" d="M8.6 2.6A2 2 0 0 1 10 2h4a2 2 0 0 1 2 2v2h3a1 1 0 1 1 0 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a1 1 0 0 1 0-2h3V4c0-.5.2-1 .6-1.4ZM10 6h4V4h-4v2Zm1 4a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Zm4 0a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Z" clip-rule="evenodd"/>\
                                        </svg>\
                                    </button>\
                                </div>'

                $('#recipeList').append(template)
                
        
            },
            error: () => {
        
                clearTimeout(timer);
                $('.loading-screen').addClass('hidden')
                toggleModal('alert-modal')
        
            }
        })

    }

    // Save order
    var dataFields = new FormData()

    const validateInoviceDatas = () => {
        
        $('#invoiceDataButton').removeClass('button-error')

        // Bestelldaten
        const salutationValue = salutation.val()
        const firstNameValue = firstName.val()
        const lastNameValue = lastName.val()
        const birthDateValue = birthDate.val()
        const streetValue = street.val()
        const streetNumberValue = streetNumber.val()
        const postalcodeValue = postalcode.val()
        const cityValue = city.val()
        const countryValue = country.val()
        const phonenumberValue = phonenumber.val()
        const emailValue = email.val()
        const commentValue = comment.val()

        const validationFields = [
            'salutation',
            'firstName',
            'lastName',
            'birthDate',
            'street',
            'streetNumber',
            'postalcode',
            'city',
            'country',
            'phonenumber',
            'email',
        ]

        const formData = {
            salutation: salutationValue,
            firstName: firstNameValue,
            lastName: lastNameValue,
            birthDate: birthDateValue,
            street: streetValue,
            streetNumber: streetNumberValue,
            postalcode: postalcodeValue,
            city: cityValue,
            country: countryValue,
            phonenumber: phonenumberValue,
            email: emailValue,
            comment: commentValue,
        }

        const formDataFields = {
            salutation: salutation,
            firstName: firstName,
            lastName: lastName,
            birthDate: birthDate,
            street: street,
            streetNumber: streetNumber,
            postalcode: postalcode,
            city: city,
            country: country,
            phonenumber: phonenumber,
            email: email,
        }

        let wrongFields = []

        // Validate all fields (defined in validationFields) for content
        const validate = (obj, fields) => {

            for (let field of fields) {
                if (!Array.isArray(field)) {
                    if (field === 'email' || field === 'mail') {
                        if (obj?.[field] === undefined || obj?.[field] === '' || !regexEmail.test(obj?.[field])) wrongFields.push(field); 
                    }
                    if (obj?.[field] === undefined || obj?.[field] === '') wrongFields.push(field);
                } else if (!obj?.[field[0]] || !checkField(obj[field[0]], field[1])) return false;
            }
            
            if (wrongFields.length != 0) {
                for (let field of wrongFields) {
                    $(formDataFields?.[field]).addClass('input-error')
                }
                $('#invoiceDataButton').addClass('button-error')
                return false;
            }
            
            dataFields.append('invoiceData', JSON.stringify(formData))
            
            return true;

        };
        return validate(formData, validationFields)

    }

    const validateDeliverDatas = () => {
        
        $('#deliverDataButton').removeClass('button-error')

        // Bestelldaten
        const firstNameValue = delFirstName.val()
        const lastNameValue = delLastName.val()
        const streetValue = delStreet.val()
        const streetNumberValue = delStreetNumber.val()
        const postalcodeValue = delPostalcode.val()
        const cityValue = delCity.val()
        const countryValue = delCountry.val()
        const commentValue = delComment.val()

        const validationFields = [
            'firstName',
            'lastName',
            'street',
            'streetNumber',
            'postalcode',
            'city',
            'country',
        ]

        const formData = {
            firstName: firstNameValue,
            lastName: lastNameValue,
            street: streetValue,
            streetNumber: streetNumberValue,
            postalcode: postalcodeValue,
            city: cityValue,
            country: countryValue,
            comment: commentValue,
        }

        const formDataFields = {
            firstName: delFirstName,
            lastName: delLastName,
            street: delStreet,
            streetNumber: delStreetNumber,
            postalcode: delPostalcode,
            city: delCity,
            country: delCountry,
        }

        let wrongFields = []

        // Validate all fields (defined in validationFields) for content
        const validate = (obj, fields) => {

            for (let field of fields) {
                if (!Array.isArray(field)) {
                    if (field === 'email' || field === 'mail') {
                        if (obj?.[field] === undefined || obj?.[field] === '' || !regexEmail.test(obj?.[field])) wrongFields.push(field); 
                    }
                    if (obj?.[field] === undefined || obj?.[field] === '') wrongFields.push(field);
                } else if (!obj?.[field[0]] || !checkField(obj[field[0]], field[1])) return false;
            }
            
            if (wrongFields.length != 0) {
                for (let field of wrongFields) {
                    $(formDataFields?.[field]).addClass('input-error')
                }
                $('#deliverDataButton').addClass('button-error')
                return false;
            }
            
            dataFields.append('deliverData', JSON.stringify(formData))
            
            return true;

        };
        return validate(formData, validationFields)

    }

    const validateRecipes = () => {

        $('#recipeButton').removeClass('button-error')
        $('#orderRecipeAlert').addClass('hidden')

        if ($('#recipeList').children().length == 0) {
            $('#recipeButton').addClass('button-error')
            $('#orderRecipeAlert').removeClass('hidden')
            return false
        }

        return true
    }

    const validateProducts = () => {

        $('#productsButton').removeClass('button-error')
        $('#orderProductsAlert').addClass('hidden')

        if ($('#productList').children().length == 0) {
            $('#productsButton').addClass('button-error')
            $('#orderProductsAlert').removeClass('hidden')
            return false
        }

        return true

    }

    const validateOrderSettings = () => {

        const validationFieldsOrderSettings = [
            'paymentType',
            'deliveryType',
            'customerType',
            'recipeStatus',
        ]

        const formDataOrderSettings = {
            'paymentType': paymentType.val(),
            'deliveryType': deliveryType.val(),
            'customerType': customerType.val(),
            'recipeStatus': recipeStatus.val(),
        }

        const formDataFieldsOrderSettings = {
            'paymentType': paymentType,
            'deliveryType': deliveryType,
            'customerType': customerType,
            'recipeStatus': recipeStatus,
        }

        let wrongFields = []

        // Validate all fields (defined in validationFields) for content
        const validateOrderSettings = (obj, fields) => {

            for (let field of fields) {
                if (!Array.isArray(field)) {
                    if (field === 'email' || field === 'mail') {
                        if (obj?.[field] === undefined || obj?.[field] === '' || !regexEmail.test(obj?.[field])) wrongFields.push(field); 
                    }
                    if (obj?.[field] === undefined || obj?.[field] === '' || obj?.[field] === null) wrongFields.push(field);
                } else if (!obj?.[field[0]] || !checkField(obj[field[0]], field[1])) return false;
            }
            
            if (wrongFields.length != 0) {
                for (let field of wrongFields) {
                    $(formDataFieldsOrderSettings?.[field]).addClass('input-error')
                }
                $(formDataFieldsOrderSettings?.[wrongFields[0]])?.focus()
                return false;
            }
            
            dataFields.append('orderSettings', JSON.stringify(formDataOrderSettings))
            
            return true;

        };
        return validateOrderSettings(formDataOrderSettings, validationFieldsOrderSettings)

    }

    const saveOrder = () => {

        $('#orderDetailsForm input').removeClass('input-error')
        $('#orderDetailsForm select').removeClass('input-error')
        
        $('#invoiceDataButton').removeClass('button-error')
        $('#deliverDataButton').removeClass('button-error')
        $('#productsButton').removeClass('button-error')
        $('#recipeButton').removeClass('button-error')

        dataFields = new FormData();

        if (validateOrderSettings() && validateInoviceDatas() && validateDeliverDatas() && validateRecipes() && validateProducts()) {

            dataFields.append('saveOrder', 'saveOrder')
            dataFields.append('orderId', orderId.val())

            var timer = setTimeout(function() {
                // Zeigen Sie den Ladebildschirm an, wenn die Ajax-Anfrage noch nicht fertig ist
                $('.loading-screen').addClass('hidden')
            }, 2000);

            $.ajax({
                type: 'POST',
                url: '{% url "request_customer_functions" %}',
                processData: false,  // Wichtig: Verhindert, dass jQuery die Daten verarbeitet
                contentType: false,
                traditional: true,
                data: dataFields,
                success: (data) => {

                    clearTimeout(timer);
                    $('.loading-screen').addClass('hidden')

                    toggleModal('order-success-modal')

                },
                error: () => {

                    clearTimeout(timer);
                    $('.loading-screen').addClass('hidden')
                    toggleModal('alert-modal')

                }
            })

        }
    }

    const deleteOrder = () => {

        $.ajax({
            type: 'POST',
            url: '{% url "request_order_functions" %}',
            traditional: true,
            data: {
                'deleteOrder': 'deleteOrder',
                'orderId': orderId.val(),
            },
            success: (data) => {

                location.reload()
        
            },
            error: () => {
        
                toggleModal('alert-modal')
        
            }
        })

    }
</script>

<!-- Filter Functions -->
<script data-baseUrl="{{ baseUrl }}">

    const searchCategories = {
        'search': 'Suche',
        'search_product': 'Produkt',
        'search_invoice': 'Rechnung',
    }

    const filterDatas = document.currentScript.dataset

    // Get Filters from URL
    const queryString = window.location.search
    var urlParams = new URLSearchParams(queryString)

    const customFilter = (filterCriterias, filterButton=null) => {

        // Show all
        if (!filterCriterias || filterCriterias == '') {
            window.location.href = filterDatas.baseurl + '?page=1'
        // Show by filter
        } else {

            if (filterButton) {
                window.location.href = filterDatas.baseurl + '?page=1&filterButton=' + $(filterButton).attr('id') + '&' + filterCriterias
            } else {
                window.location.href = filterDatas.baseurl + '?page=1&' + filterCriterias
            }
        }

    }

    // Select search category
    const selectSearchCategory = (element, category) => {
        
        $('#searchDropdownButton span').html($(element).html())
        $('#searchOrderInput').attr('placeholder', 'Suche nach ' + $(element).html())
        $('#searchOrderInput').attr('data-search-category', category)

    }

    // Search Order
    const searchOrder = () => {

        const searchValue = $('#searchOrderInput').val()
        const searchCategory = $('#searchOrderInput').attr('data-search-category')

        // Remove all search parameters in searchCategories
        for (const [key, value] of Object.entries(searchCategories)) {
            if (key !== searchCategory) {
                urlParams.delete(key)
            }
        }

        updateUrlParameters(searchCategory, searchValue)
    }

    $('#searchOrderInput').on('keyup', function (e) {
        if (e.key === 'Enter' || e.keyCode === 13) {
            searchOrder()
        }
    })

    // Update url parameters by class_name and value
    const updateUrlParameters = (class_name, value) => {

        if (value) {

            if (urlParams.get(class_name) === undefined || urlParams.get(class_name) === '' || urlParams.get(class_name) === null || class_name=='search' || class_name=='search_product' || class_name=='search_invoice') {
                urlParams.set(class_name, value)
            } else {

                let temp_values = urlParams.get(class_name).split(',')

                if (temp_values.includes(value)) {
                    temp_values = temp_values.filter(item => item !== value)
                } else {
                    temp_values.push(value)
                }

                if (temp_values.length === 0 || temp_values === undefined) {
                    urlParams.delete(class_name)
                } else {
                    urlParams.set(class_name, temp_values.join(','))
                }

            }
        } else {
            urlParams.delete(class_name)
        }

        urlParams.set('page', 1)

        let newUrlParams = new URLSearchParams(urlParams).toString()

        window.location.href = (filterDatas.baseurl + '?' + newUrlParams.replace(/%2C/g, ','))

    }

    // Remove url parameters by class_name
    const removeUrlParameters = (class_name) => {

        urlParams.delete(class_name)
        urlParams.set('page', 1)

        let newUrlParams = new URLSearchParams(urlParams).toString()

        window.location.href = (filterDatas.baseurl + '?' + newUrlParams.replace(/%2C/g, ','))

    }

    // Remove all filters
    const resetFilter = () => {
        window.location.href = filterDatas.baseurl + '?page=1'
    }

</script>

<!-- New recipe file -->
<script>

    const newRecipeFileInput = $('input[name="newRecipeFile"]', '#uploadRecipeForm')
    const recipeOrderIdInput = $('input[name="orderId"]', '#uploadRecipeForm')
    const recipeERecipeCheckbox = $('input[name="eRecipe"]', '#uploadRecipeForm')
    const recipeNumberInput = $('input[name="recipeNumber"]', '#uploadRecipeForm')

    const recipeFileAlert = $('#uploadRecipeForm [name="recipeFileAlert"]')
    const recipeNumberAlert = $('#uploadRecipeForm [name="recipeNumberAlert"]')

    const uploadNewRecipeFile = () => {

        const orderId = orderIdInput.val()

        $('#upload-recipe-popup-modal input[name="orderId"]').val(orderId)
        $('#upload-recipe-popup-modal [name="order_number"]').html(orderNumber.html())

        // close order modal
        hideModal('orderModal')

        // open upload recipe file modal
        toggleModal('upload-recipe-popup-modal')

    }

    const changeRecipeType = (element) => {

        // show recipe number field if not checked
        if (!element.checked) {
            recipeNumberInput.removeClass('hidden')
        } else {
            recipeNumberInput.addClass('hidden')
        }

    }

    const saveUploadNewRecipe = () => {
            
        const orderId = recipeOrderIdInput.val()
        const eRecipe = recipeERecipeCheckbox.prop('checked')
        const recipeNumber = recipeNumberInput.val()

        const formData = new FormData()
        formData.append('uploadNewRecipe', 'uploadNewRecipe')
        formData.append('orderId', orderId)
        formData.append('eRecipe', JSON.stringify(eRecipe))
        formData.append('recipeNumber', recipeNumber)
        formData.append('recipeFile', newRecipeFileInput[0].files[0])

        // validate if recipe file input is empty
        if (!newRecipeFileInput[0].files[0]) {
            recipeFileAlert.removeClass('hidden')
            return
        } else {
            recipeFileAlert.addClass('hidden')
        }

        // Alert if eRecipe is not checked and recipe number is empty
        if (!eRecipe && recipeNumber === '') {
            recipeNumberAlert.removeClass('hidden')
            return
        } else {
            recipeNumberAlert.addClass('hidden')
        }

        $('.loading-screen').removeClass('hidden')

        $.ajax({
            type: 'POST',
            url: '{% url "request_order_functions" %}',
            processData: false,  // Wichtig: Verhindert, dass jQuery die Daten verarbeitet
            contentType: false,
            traditional: true,
            data: formData,
            success: (data) => {

                $('.loading-screen').addClass('hidden')
                hideModal('upload-recipe-popup-modal')
                showToast('successToast', 'Rezept erfolgreich hochgeladen.')

                getOrderDetails(orderId)

            },
            error: () => {
        
                $('.loading-screen').addClass('hidden')
                hideModal('upload-recipe-popup-modal')
                toggleModal('alert-modal')
        
            }
        })
    }

</script>

{% endblock %}